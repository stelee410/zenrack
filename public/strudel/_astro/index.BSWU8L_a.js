typeof BigInt>"u"&&(BigInt=function(t){if(isNaN(t))throw new Error("");return t});const g=BigInt(0),b=BigInt(1),_t=BigInt(2),Ft=BigInt(5),J=BigInt(10),np=2e3,w={s:b,n:g,d:b};function X(t,e){try{t=BigInt(t)}catch{throw nt()}return t*e}function U(t){return typeof t=="bigint"?t:Math.floor(t)}function x(t,e){if(e===g)throw Zt();const n=Object.create(B.prototype);n.s=t<g?-b:b,t=t<g?-t:t;const s=ct(t,e);return n.n=t/s,n.d=e/s,n}function at(t){const e={};let n=t,s=_t,r=Ft-b;for(;r<=n;){for(;n%s===g;)n/=s,e[s]=(e[s]||g)+b;r+=b+_t*s++}return n!==t?n>1&&(e[n]=(e[n]||g)+b):e[t]=(e[t]||g)+b,e}const N=function(t,e){let n=g,s=b,r=b;if(t!=null)if(e!==void 0){if(typeof t=="bigint")n=t;else{if(isNaN(t))throw nt();if(t%1!==0)throw Te();n=BigInt(t)}if(typeof e=="bigint")s=e;else{if(isNaN(e))throw nt();if(e%1!==0)throw Te();s=BigInt(e)}r=n*s}else if(typeof t=="object"){if("d"in t&&"n"in t)n=BigInt(t.n),s=BigInt(t.d),"s"in t&&(n*=BigInt(t.s));else if(0 in t)n=BigInt(t[0]),1 in t&&(s=BigInt(t[1]));else if(typeof t=="bigint")n=t;else throw nt();r=n*s}else if(typeof t=="number"){if(isNaN(t))throw nt();if(t<0&&(r=-b,t=-t),t%1===0)n=BigInt(t);else if(t>0){let o=1,c=0,u=1,a=1,l=1,h=1e7;for(t>=1&&(o=10**Math.floor(1+Math.log10(t)),t/=o);u<=h&&l<=h;){let p=(c+a)/(u+l);if(t===p){u+l<=h?(n=c+a,s=u+l):l>u?(n=a,s=l):(n=c,s=u);break}else t>p?(c+=a,u+=l):(a+=c,l+=u),u>h?(n=a,s=l):(n=c,s=u)}n=BigInt(n)*BigInt(o),s=BigInt(s)}}else if(typeof t=="string"){let o=0,c=g,u=g,a=g,l=b,h=b,p=t.replace(/_/g,"").match(/\d+|./g);if(p===null)throw nt();if(p[o]==="-"?(r=-b,o++):p[o]==="+"&&o++,p.length===o+1?u=X(p[o++],r):p[o+1]==="."||p[o]==="."?(p[o]!=="."&&(c=X(p[o++],r)),o++,(o+1===p.length||p[o+1]==="("&&p[o+3]===")"||p[o+1]==="'"&&p[o+3]==="'")&&(u=X(p[o],r),l=J**BigInt(p[o].length),o++),(p[o]==="("&&p[o+2]===")"||p[o]==="'"&&p[o+2]==="'")&&(a=X(p[o+1],r),h=J**BigInt(p[o+1].length)-b,o+=3)):p[o+1]==="/"||p[o+1]===":"?(u=X(p[o],r),l=X(p[o+2],b),o+=3):p[o+3]==="/"&&p[o+1]===" "&&(c=X(p[o],r),u=X(p[o+2],r),l=X(p[o+4],b),o+=5),p.length<=o)s=l*h,r=n=a+s*c+h*u;else throw nt()}else if(typeof t=="bigint")n=t,r=t,s=b;else throw nt();if(s===g)throw Zt();w.s=r<g?-b:b,w.n=n<g?-n:n,w.d=s<g?-s:s};function sp(t,e,n){let s=b;for(;e>g;t=t*t%n,e>>=b)e&b&&(s=s*t%n);return s}function rp(t,e){for(;e%_t===g;e/=_t);for(;e%Ft===g;e/=Ft);if(e===b)return g;let n=J%e,s=1;for(;n!==b;s++)if(n=n*J%e,s>np)return g;return BigInt(s)}function op(t,e,n){let s=b,r=sp(J,n,e);for(let o=0;o<300;o++){if(s===r)return BigInt(o);s=s*J%e,r=r*J%e}return 0}function ct(t,e){if(!t)return e;if(!e)return t;for(;;){if(t%=e,!t)return e;if(e%=t,!e)return t}}function B(t,e){if(N(t,e),this instanceof B)t=ct(w.d,w.n),this.s=w.s,this.n=w.n/t,this.d=w.d/t;else return x(w.s*w.n,w.d)}var Zt=function(){return new Error("Division by Zero")},nt=function(){return new Error("Invalid argument")},Te=function(){return new Error("Parameters must be integer")};B.prototype={s:b,n:g,d:b,abs:function(){return x(this.n,this.d)},neg:function(){return x(-this.s*this.n,this.d)},add:function(t,e){return N(t,e),x(this.s*this.n*w.d+w.s*this.d*w.n,this.d*w.d)},sub:function(t,e){return N(t,e),x(this.s*this.n*w.d-w.s*this.d*w.n,this.d*w.d)},mul:function(t,e){return N(t,e),x(this.s*w.s*this.n*w.n,this.d*w.d)},div:function(t,e){return N(t,e),x(this.s*w.s*this.n*w.d,this.d*w.n)},clone:function(){return x(this.s*this.n,this.d)},mod:function(t,e){if(t===void 0)return x(this.s*this.n%this.d,b);if(N(t,e),g===w.n*this.d)throw Zt();return x(this.s*(w.d*this.n)%(w.n*this.d),w.d*this.d)},gcd:function(t,e){return N(t,e),x(ct(w.n,this.n)*ct(w.d,this.d),w.d*this.d)},lcm:function(t,e){return N(t,e),w.n===g&&this.n===g?x(g,b):x(w.n*this.n,ct(w.n,this.n)*ct(w.d,this.d))},inverse:function(){return x(this.s*this.d,this.n)},pow:function(t,e){if(N(t,e),w.d===b)return w.s<g?x((this.s*this.d)**w.n,this.n**w.n):x((this.s*this.n)**w.n,this.d**w.n);if(this.s<g)return null;let n=at(this.n),s=at(this.d),r=b,o=b;for(let c in n)if(c!=="1"){if(c==="0"){r=g;break}if(n[c]*=w.n,n[c]%w.d===g)n[c]/=w.d;else return null;r*=BigInt(c)**n[c]}for(let c in s)if(c!=="1"){if(s[c]*=w.n,s[c]%w.d===g)s[c]/=w.d;else return null;o*=BigInt(c)**s[c]}return w.s<g?x(o,r):x(r,o)},log:function(t,e){if(N(t,e),this.s<=g||w.s<=g)return null;const n={},s=at(w.n),r=at(w.d),o=at(this.n),c=at(this.d);for(const l in r)s[l]=(s[l]||g)-r[l];for(const l in c)o[l]=(o[l]||g)-c[l];for(const l in s)l!=="1"&&(n[l]=!0);for(const l in o)l!=="1"&&(n[l]=!0);let u=null,a=null;for(const l in n){const h=s[l]||g,p=o[l]||g;if(h===g){if(p!==g)return null;continue}let k=p,_=h;const A=ct(k,_);if(k/=A,_/=A,u===null&&a===null)u=k,a=_;else if(k*a!==u*_)return null}return u!==null&&a!==null?x(u,a):null},equals:function(t,e){return N(t,e),this.s*this.n*w.d===w.s*w.n*this.d},lt:function(t,e){return N(t,e),this.s*this.n*w.d<w.s*w.n*this.d},lte:function(t,e){return N(t,e),this.s*this.n*w.d<=w.s*w.n*this.d},gt:function(t,e){return N(t,e),this.s*this.n*w.d>w.s*w.n*this.d},gte:function(t,e){return N(t,e),this.s*this.n*w.d>=w.s*w.n*this.d},compare:function(t,e){N(t,e);let n=this.s*this.n*w.d-w.s*w.n*this.d;return(g<n)-(n<g)},ceil:function(t){return t=J**BigInt(t||0),x(U(this.s*t*this.n/this.d)+(t*this.n%this.d>g&&this.s>=g?b:g),t)},floor:function(t){return t=J**BigInt(t||0),x(U(this.s*t*this.n/this.d)-(t*this.n%this.d>g&&this.s<g?b:g),t)},round:function(t){return t=J**BigInt(t||0),x(U(this.s*t*this.n/this.d)+this.s*((this.s>=g?b:g)+_t*(t*this.n%this.d)>this.d?b:g),t)},roundTo:function(t,e){N(t,e);const n=this.n*w.d,s=this.d*w.n,r=n%s;let o=U(n/s);return r+r>=s&&o++,x(this.s*o*w.n,w.d)},divisible:function(t,e){return N(t,e),!(!(w.n*this.d)||this.n*w.d%(w.n*this.d))},valueOf:function(){return Number(this.s*this.n)/Number(this.d)},toString:function(t){let e=this.n,n=this.d;t=t||15;let s=rp(e,n),r=op(e,n,s),o=this.s<g?"-":"";if(o+=U(e/n),e%=n,e*=J,e&&(o+="."),s){for(let c=r;c--;)o+=U(e/n),e%=n,e*=J;o+="(";for(let c=s;c--;)o+=U(e/n),e%=n,e*=J;o+=")"}else for(let c=t;e&&c--;)o+=U(e/n),e%=n,e*=J;return o},toFraction:function(t){let e=this.n,n=this.d,s=this.s<g?"-":"";if(n===b)s+=e;else{let r=U(e/n);t&&r>g&&(s+=r,s+=" ",e%=n),s+=e,s+="/",s+=n}return s},toLatex:function(t){let e=this.n,n=this.d,s=this.s<g?"-":"";if(n===b)s+=e;else{let r=U(e/n);t&&r>g&&(s+=r,e%=n),s+="\\frac{",s+=e,s+="}{",s+=n,s+="}"}return s},toContinued:function(){let t=this.n,e=this.d,n=[];do{n.push(U(t/e));let s=t%e;t=e,e=s}while(t!==b);return n},simplify:function(t){const e=BigInt(1/(t||.001)|0),n=this.abs(),s=n.toContinued();for(let r=1;r<s.length;r++){let o=x(s[r-1],b);for(let u=r-2;u>=0;u--)o=o.inverse().add(s[u]);let c=o.sub(n);if(c.n*e<c.d)return o.mul(this.s)}return this}};const Xt="strudel.log";let ip=1e3,Ce,xe;function zt(t,e="cyclist"){$(`[${e}] error: ${t.message}`)}function $(t,e,n={}){let s=performance.now();Ce===t&&s-xe<ip||(Ce=t,xe=s,console.log(`%c${t}`,"background-color: black;color:white;border-radius:15px"),typeof document<"u"&&typeof CustomEvent<"u"&&document.dispatchEvent(new CustomEvent(Xt,{detail:{message:t,type:e,data:n}})))}$.key=Xt;const cp=t=>/^[a-gA-G][#bsf]*[0-9]*$/.test(t),Mt=t=>/^[a-gA-G][#bsf]*-?[0-9]*$/.test(t),Ne=t=>{if(typeof t!="string")return[];const[e,n="",s]=t.match(/^([a-gA-G])([#bsf]*)(-?[0-9]*)$/)?.slice(1)||[];return e?[e,n,s?Number(s):void 0]:[]},up={c:0,d:2,e:4,f:5,g:7,a:9,b:11},ap={"#":1,b:-1,s:1,f:-1},Pe=t=>t?.split("").reduce((e,n)=>e+ap[n],0)||0,qt=(t,e=3)=>{const[n,s,r=e]=Ne(t);if(!n)throw new Error('not a note: "'+t+'"');const o=up[n.toLowerCase()],c=Pe(s);return(Number(r)+1)*12+o+c},ft=t=>Math.pow(2,(t-69)/12)*440,Ie=t=>12*Math.log(t/440)/Math.LN2+69,lp=(t,e)=>{if(typeof t!="object")throw new Error("valueToMidi: expected object value");let{freq:n,note:s}=t;if(typeof n=="number")return Ie(n);if(typeof s=="string")return qt(s);if(typeof s=="number")return s;if(!e)throw new Error("valueToMidi: expected freq or note to be set");return e},fp=(t,e)=>(t-e)*1e3,je=t=>ft(typeof t=="number"?t:qt(t)),pp=["C","Db","D","Eb","E","F","Gb","G","Ab","A","Bb","B"],hp=t=>{const e=Math.floor(t/12)-1;return pp[t%12]+e},At=(t,e)=>(t%e+e)%e,Je=t=>t.reduce((e,n)=>e+n)/t.length;function $e(t,e=0){return isNaN(Number(t))?($(`"${t}" is not a number, falling back to ${e}`,"warning"),e):t}const dp=(t,e)=>At(Math.round($e(t??0,0)),e),mp=t=>{let{value:e,context:n}=t,s=e;if(typeof s=="object"&&!Array.isArray(s)&&(s=s.note||s.n||s.value,s===void 0))throw new Error(`cannot find a playable note for ${JSON.stringify(e)}`);if(typeof s=="number"&&n.type!=="frequency")s=ft(t.value);else if(typeof s=="number"&&n.type==="frequency")s=t.value;else if(typeof s!="string"||!Mt(s))throw new Error("not a note: "+JSON.stringify(s));return s},yp=t=>{let{value:e,context:n}=t;if(typeof e=="object")return e.freq?e.freq:je(e.note||e.n||e.value);if(typeof e=="number"&&n.type!=="frequency")e=ft(t.value);else if(typeof e=="string"&&Mt(e))e=ft(qt(t.value));else if(typeof e!="number")throw new Error("not a note or frequency: "+e);return e},Le=(t,e)=>t.slice(e).concat(t.slice(0,e)),Re=(...t)=>t.reduce((e,n)=>(...s)=>e(n(...s)),e=>e),wp=(...t)=>Re(...t.reverse()),ht=t=>t.filter(e=>e!=null),Y=t=>[].concat(...t),lt=t=>t,gp=(t,e)=>t,St=(t,e)=>Array.from({length:e-t+1},(n,s)=>s+t);function v(t,e,n=t.length){const s=function r(...o){if(o.length>=n)return t.apply(this,o);{const c=function(...u){return r.apply(this,o.concat(u))};return e&&e(c,o),c}};return e&&e(s,[]),s}function Yt(t){const e=Number(t);if(!isNaN(e))return e;if(Mt(t))return qt(t);throw new Error(`cannot parse as numeral: "${t}"`)}function te(t,e){return(...n)=>t(...n.map(e))}function D(t){return te(t,Yt)}function We(t){const e=Number(t);if(!isNaN(e))return e;const n={pi:Math.PI,w:1,h:.5,q:.25,e:.125,s:.0625,t:1/3,f:.2,x:1/6}[t];if(typeof n<"u")return n;throw new Error(`cannot parse as fractional: "${t}"`)}const bp=t=>te(t,We),ee=function(t,e){return[e.slice(0,t),e.slice(t)]},Et=(t,e,n)=>e.map((s,r)=>t(s,n[r])),Fe=function(t){const e=[];for(let n=0;n<t.length-1;++n)e.push([t[n],t[n+1]]);return e},Ve=(t,e,n)=>Math.min(Math.max(t,e),n),_p=["Do","Reb","Re","Mib","Mi","Fa","Solb","Sol","Lab","La","Sib","Si"],vp=["Sa","Re","Ga","Ma","Pa","Dha","Ni"],kp=["C","Db","D","Eb","E","F","Gb","G","Ab","A","Hb","H"],qp=["Ni","Pab","Pa","Voub","Vou","Ga","Dib","Di","Keb","Ke","Zob","Zo"],Ap=["I","Ro","Ha","Ni","Ho","He","To"],Sp=["C","Db","D","Eb","E","F","Gb","G","Ab","A","Bb","B"],Bp=(t,e="letters")=>{const s=(e==="solfeggio"?_p:e==="indian"?vp:e==="german"?kp:e==="byzantine"?qp:e==="japanese"?Ap:Sp)[t%12],r=Math.floor(t/12)-1;return s+r};function Tp(t){var e={};return t.filter(function(n){return e.hasOwn(n)?!1:e[n]=!0})}function Cp(t){return t.sort().filter(function(e,n,s){return!n||e!=s[n-1]})}function De(t){return t.sort((e,n)=>e.compare(n)).filter(function(e,n,s){return!n||e.ne(s[n-1])})}function He(t){const e=new TextEncoder().encode(t);return btoa(String.fromCharCode(...e))}function Ge(t){const e=new Uint8Array(atob(t).split("").map(s=>s.charCodeAt(0)));return new TextDecoder().decode(e)}function xp(t){return encodeURIComponent(He(t))}function Op(t){return Ge(decodeURIComponent(t))}function Qe(t,e){return Array.isArray(t)?t.map(e):Object.fromEntries(Object.entries(t).map(([n,s],r)=>[n,e(s,n,r)]))}function Vt(t,e){return t/e}class Ue{constructor({getTargetClockTime:e=Mp,weight:n=16,offsetDelta:s=.005,checkAfterTime:r=2,resetAfterTime:o=8}){this.offsetTime,this.timeAtPrevOffsetSample,this.prevOffsetTimes=[],this.getTargetClockTime=e,this.weight=n,this.offsetDelta=s,this.checkAfterTime=r,this.resetAfterTime=o,this.reset=()=>{this.prevOffsetTimes=[],this.offsetTime=null,this.timeAtPrevOffsetSample=null}}calculateOffset(e){const n=this.getTargetClockTime(),s=n-this.timeAtPrevOffsetSample,r=n-e;if(s>this.resetAfterTime&&this.reset(),this.offsetTime==null&&(this.offsetTime=r),this.prevOffsetTimes.push(r),this.prevOffsetTimes.length>this.weight&&this.prevOffsetTimes.shift(),this.timeAtPrevOffsetSample==null||s>this.checkAfterTime){this.timeAtPrevOffsetSample=n;const o=Je(this.prevOffsetTimes);Math.abs(o-this.offsetTime)>this.offsetDelta&&(this.offsetTime=o)}return this.offsetTime}calculateTimestamp(e,n){return this.calculateOffset(e)+n}}function zp(){return performance.now()*.001}function Mp(){return Date.now()*.001}const Ke=new Map([["control","Control"],["ctrl","Control"],["alt","Alt"],["shift","Shift"],["down","ArrowDown"],["up","ArrowUp"],["left","ArrowLeft"],["right","ArrowRight"]]);let gt;function Ze(){if(gt==null){if(typeof window>"u")return;gt={},window.addEventListener("keydown",t=>{gt[t.key]=!0}),window.addEventListener("keyup",t=>{gt[t.key]=!1})}return{...gt}}function ne(t,e=!1){return typeof t=="object"?e?JSON.stringify(t).slice(1,-1).replaceAll('"',"").replaceAll(","," "):JSON.stringify(t):t}B.prototype.sam=function(){return this.floor()};B.prototype.nextSam=function(){return this.sam().add(1)};B.prototype.wholeCycle=function(){return new M(this.sam(),this.nextSam())};B.prototype.cyclePos=function(){return this.sub(this.sam())};B.prototype.lt=function(t){return this.compare(t)<0};B.prototype.gt=function(t){return this.compare(t)>0};B.prototype.lte=function(t){return this.compare(t)<=0};B.prototype.gte=function(t){return this.compare(t)>=0};B.prototype.eq=function(t){return this.compare(t)==0};B.prototype.ne=function(t){return this.compare(t)!=0};B.prototype.max=function(t){return this.gt(t)?this:t};B.prototype.maximum=function(...t){return t=t.map(e=>new B(e)),t.reduce((e,n)=>n.max(e),this)};B.prototype.min=function(t){return this.lt(t)?this:t};B.prototype.mulmaybe=function(t){return t!==void 0?this.mul(t):void 0};B.prototype.divmaybe=function(t){return t!==void 0?this.div(t):void 0};B.prototype.addmaybe=function(t){return t!==void 0?this.add(t):void 0};B.prototype.submaybe=function(t){return t!==void 0?this.sub(t):void 0};B.prototype.show=function(){return this.s*this.n+"/"+this.d};B.prototype.or=function(t){return this.eq(0)?t:this};const y=t=>B(t),Ep=(...t)=>{if(t=ht(t),t.length!==0)return t.reduce((e,n)=>e.gcd(n),y(1))},ut=(...t)=>{if(t=ht(t),t.length===0)return;const e=t.pop();return t.reduce((n,s)=>n===void 0||s===void 0?void 0:n.lcm(s),e)},Np=t=>t instanceof B;y._original=B;class M{constructor(e,n){this.begin=y(e),this.end=y(n)}get spanCycles(){const e=[];var n=this.begin;const s=this.end,r=s.sam();if(n.equals(s))return[new M(n,s)];for(;s.gt(n);){if(n.sam().equals(r)){e.push(new M(n,this.end));break}const o=n.nextSam();e.push(new M(n,o)),n=o}return e}get duration(){return this.end.sub(this.begin)}cycleArc(){const e=this.begin.cyclePos(),n=e.add(this.duration);return new M(e,n)}withTime(e){return new M(e(this.begin),e(this.end))}withEnd(e){return new M(this.begin,e(this.end))}withCycle(e){const n=this.begin.sam(),s=n.add(e(this.begin.sub(n))),r=n.add(e(this.end.sub(n)));return new M(s,r)}intersection(e){const n=this.begin.max(e.begin),s=this.end.min(e.end);if(!n.gt(s)&&!(n.equals(s)&&(n.equals(this.end)&&this.begin.lt(this.end)||n.equals(e.end)&&e.begin.lt(e.end))))return new M(n,s)}intersection_e(e){const n=this.intersection(e);if(n==null)throw"TimeSpans do not intersect";return n}midpoint(){return this.begin.add(this.duration.div(y(2)))}equals(e){return this.begin.equals(e.begin)&&this.end.equals(e.end)}show(){return this.begin.show()+" → "+this.end.show()}}class T{constructor(e,n,s,r={},o=!1){this.whole=e,this.part=n,this.value=s,this.context=r,this.stateful=o,o&&console.assert(typeof this.value=="function","Stateful values must be functions")}get duration(){let e;return typeof this.value?.duration=="number"?e=y(this.value.duration):e=this.whole.end.sub(this.whole.begin),typeof this.value?.clip=="number"?e.mul(this.value.clip):e}get endClipped(){return this.whole.begin.add(this.duration)}isActive(e){return this.whole.begin<=e&&this.endClipped>=e}isInPast(e){return e>this.endClipped}isInNearPast(e,n){return n-e<=this.endClipped}isInFuture(e){return e<this.whole.begin}isInNearFuture(e,n){return n<this.whole.begin&&n>this.whole.begin-e}isWithinTime(e,n){return this.whole.begin<=n&&this.endClipped>=e}wholeOrPart(){return this.whole?this.whole:this.part}withSpan(e){const n=this.whole?e(this.whole):void 0;return new T(n,e(this.part),this.value,this.context)}withValue(e){return new T(this.whole,this.part,e(this.value),this.context)}hasOnset(){return this.whole!=null&&this.whole.begin.equals(this.part.begin)}hasTag(e){return this.context.tags?.includes(e)}resolveState(e){if(this.stateful&&this.hasOnset()){console.log("stateful");const n=this.value,[s,r]=n(e);return[s,new T(this.whole,this.part,r,this.context,!1)]}return[e,this]}spanEquals(e){return this.whole==null&&e.whole==null||this.whole.equals(e.whole)}equals(e){return this.spanEquals(e)&&this.part.equals(e.part)&&this.value===e.value}show(e=!1){const n=typeof this.value=="object"?e?JSON.stringify(this.value).slice(1,-1).replaceAll('"',"").replaceAll(","," "):JSON.stringify(this.value):this.value;var s="";if(this.whole==null)s="~"+this.part.show;else{var r=this.whole.begin.equals(this.part.begin)&&this.whole.end.equals(this.part.end);this.whole.begin.equals(this.part.begin)||(s=this.whole.begin.show()+" ⇜ "),r||(s+="("),s+=this.part.show(),r||(s+=")"),this.whole.end.equals(this.part.end)||(s+=" ⇝ "+this.whole.end.show())}return"[ "+s+" | "+n+" ]"}showWhole(e=!1){return`${this.whole==null?"~":this.whole.show()}: ${ne(this.value,e)}`}combineContext(e){const n=this;return{...n.context,...e.context,locations:(n.context.locations||[]).concat(e.context.locations||[])}}setContext(e){return new T(this.whole,this.part,this.value,e)}ensureObjectValue(){if(typeof this.value!="object")throw new Error(`expected hap.value to be an object, but got "${this.value}". Hint: append .note() or .s() to the end`,"error")}}class pt{constructor(e,n={}){this.span=e,this.controls=n}setSpan(e){return new pt(e,this.controls)}withSpan(e){return this.setSpan(e(this.span))}setControls(e){return new pt(this.span,{...this.controls,...e})}}function Pp(t,e,n){if(e?.value!==void 0&&Object.keys(e).length===1)return $("[warn]: Can't do arithmetic on control pattern."),t;const s=Object.keys(t).filter(r=>Object.keys(e).includes(r));return Object.assign({},t,e,Object.fromEntries(s.map(r=>[r,n(t[r],e[r])])))}v((t,e)=>t*e);v((t,e)=>e.map(t));function Xe(t,e=60){let n=0,s=y(0),r=[""],o="";for(;r[0].length<e;){const c=t.queryArc(n,n+1),u=c.filter(h=>h.hasOnset()).map(h=>h.duration),a=Ep(...u),l=a.inverse();r=r.map(h=>h+"|"),o+="|";for(let h=0;h<l;h++){const[p,k]=[s,s.add(a)],_=c.filter(O=>O.whole.begin.lte(p)&&O.whole.end.gte(k)),A=_.length-r.length;A>0&&(r=r.concat(Array(A).fill(o))),r=r.map((O,W)=>{const F=_[W];if(F){const z=F.whole.begin.eq(p)?""+F.value:"-";return O+z}return O+"."}),o+=".",s=s.add(a)}n++}return r.join(`
`)}let Dt,G=!0;const Ip=function(t){G=!!t},jp=t=>Dt=t;class d{constructor(e,n=void 0){this.query=e,this._Pattern=!0,this._steps=n}get _steps(){return this.__steps}set _steps(e){this.__steps=e===void 0?void 0:y(e)}setSteps(e){return this._steps=e,this}withSteps(e){return G?new d(this.query,this._steps===void 0?void 0:e(this._steps)):this}get hasSteps(){return this._steps!==void 0}withValue(e){const n=new d(s=>this.query(s).map(r=>r.withValue(e)));return n._steps=this._steps,n}withState(e){return new d(n=>this.query(e(n)))}fmap(e){return this.withValue(e)}appWhole(e,n){const s=this,r=function(o){const c=s.query(o),u=n.query(o),a=function(l,h){const p=l.part.intersection(h.part);if(p!=null)return new T(e(l.whole,h.whole),p,l.value(h.value),h.combineContext(l))};return Y(c.map(l=>ht(u.map(h=>a(l,h)))))};return new d(r)}appBoth(e){const n=this,s=function(o,c){if(!(o==null||c==null))return o.intersection_e(c)},r=n.appWhole(s,e);return G&&(r._steps=ut(e._steps,n._steps)),r}appLeft(e){const n=this,s=function(o){const c=[];for(const u of n.query(o)){const a=e.query(o.setSpan(u.wholeOrPart()));for(const l of a){const h=u.whole,p=u.part.intersection(l.part);if(p){const k=u.value(l.value),_=l.combineContext(u),A=new T(h,p,k,_);c.push(A)}}}return c},r=new d(s);return r._steps=this._steps,r}appRight(e){const n=this,s=function(o){const c=[];for(const u of e.query(o)){const a=n.query(o.setSpan(u.wholeOrPart()));for(const l of a){const h=u.whole,p=l.part.intersection(u.part);if(p){const k=l.value(u.value),_=u.combineContext(l),A=new T(h,p,k,_);c.push(A)}}}return c},r=new d(s);return r._steps=e._steps,r}bindWhole(e,n){const s=this,r=function(o){const c=function(a,l){return new T(e(a.whole,l.whole),l.part,l.value,Object.assign({},a.context,l.context,{locations:(a.context.locations||[]).concat(l.context.locations||[])}))},u=function(a){return n(a.value).query(o.setSpan(a.part)).map(l=>c(a,l))};return Y(s.query(o).map(a=>u(a)))};return new d(r)}bind(e){const n=function(s,r){if(!(s==null||r==null))return s.intersection_e(r)};return this.bindWhole(n,e)}join(){return this.bind(lt)}outerBind(e){return this.bindWhole(n=>n,e).setSteps(this._steps)}outerJoin(){return this.outerBind(lt)}innerBind(e){return this.bindWhole((n,s)=>s,e)}innerJoin(){return this.innerBind(lt)}resetJoin(e=!1){const n=this;return new d(s=>n.discreteOnly().query(s).map(r=>r.value.late(e?r.whole.begin:r.whole.begin.cyclePos()).query(s).map(o=>new T(o.whole?o.whole.intersection(r.whole):void 0,o.part.intersection(r.part),o.value).setContext(r.combineContext(o))).filter(o=>o.part)).flat())}restartJoin(){return this.resetJoin(!0)}squeezeJoin(){const e=this;function n(s){const r=e.discreteOnly().query(s);function o(u){const l=u.value._focusSpan(u.wholeOrPart()).query(s.setSpan(u.part));function h(p,k){let _;if(k.whole&&p.whole&&(_=k.whole.intersection(p.whole),!_))return;const A=k.part.intersection(p.part);if(!A)return;const O=k.combineContext(p);return new T(_,A,k.value,O)}return l.map(p=>h(u,p))}return Y(r.map(o)).filter(u=>u)}return new d(n)}squeezeBind(e){return this.fmap(e).squeezeJoin()}polyJoin=function(){const e=this;return e.fmap(n=>n.extend(e._steps.div(n._steps))).outerJoin()};polyBind(e){return this.fmap(e).polyJoin()}queryArc(e,n,s={}){try{return this.query(new pt(new M(e,n),s))}catch(r){return zt(r,"query"),[]}}splitQueries(){const e=this,n=s=>Y(s.span.spanCycles.map(r=>e.query(s.setSpan(r))));return new d(n)}withQuerySpan(e){return new d(n=>this.query(n.withSpan(e)))}withQuerySpanMaybe(e){const n=this;return new d(s=>{const r=s.withSpan(e);return r.span?n.query(r):[]})}withQueryTime(e){return new d(n=>this.query(n.withSpan(s=>s.withTime(e))))}withHapSpan(e){return new d(n=>this.query(n).map(s=>s.withSpan(e)))}withHapTime(e){return this.withHapSpan(n=>n.withTime(e))}withHaps(e){const n=new d(s=>e(this.query(s),s));return n._steps=this._steps,n}withHap(e){return this.withHaps(n=>n.map(e))}setContext(e){return this.withHap(n=>n.setContext(e))}withContext(e){const n=this.withHap(s=>s.setContext(e(s.context)));return this.__pure!==void 0&&(n.__pure=this.__pure,n.__pure_loc=this.__pure_loc),n}stripContext(){return this.withHap(e=>e.setContext({}))}withLoc(e,n){const s={start:e,end:n},r=this.withContext(o=>{const c=(o.locations||[]).concat([s]);return{...o,locations:c}});return this.__pure&&(r.__pure=this.__pure,r.__pure_loc=s),r}filterHaps(e){return new d(n=>this.query(n).filter(e))}filterValues(e){return new d(n=>this.query(n).filter(s=>e(s.value))).setSteps(this._steps)}removeUndefineds(){return this.filterValues(e=>e!=null)}onsetsOnly(){return this.filterHaps(e=>e.hasOnset())}discreteOnly(){return this.filterHaps(e=>e.whole)}defragmentHaps(){return this.discreteOnly().withHaps(n=>{const s=[];for(var r=0;r<n.length;++r){for(var o=!0,c=n[r];o;){const l=JSON.stringify(n[r].value);for(var u=!1,a=r+1;a<n.length;a++){const h=n[a];if(c.whole.equals(h.whole)){if(c.part.begin.eq(h.part.end)){if(l===JSON.stringify(h.value)){c=new T(c.whole,new M(h.part.begin,c.part.end),c.value),n.splice(a,1),u=!0;break}}else if(h.part.begin.eq(c.part.end)&&l==JSON.stringify(h.value)){c=new T(c.whole,new M(c.part.begin,h.part.end),c.value),n.splice(a,1),u=!0;break}}}o=u}s.push(c)}return s})}firstCycle(e=!1){var n=this;return e||(n=n.stripContext()),n.query(new pt(new M(y(0),y(1))))}get firstCycleValues(){return this.firstCycle().map(e=>e.value)}get showFirstCycle(){return this.firstCycle().map(e=>`${e.value}: ${e.whole.begin.toFraction()} - ${e.whole.end.toFraction()}`)}sortHapsByPart(){return this.withHaps(e=>e.sort((n,s)=>n.part.begin.sub(s.part.begin).or(n.part.end.sub(s.part.end)).or(n.whole.begin.sub(s.whole.begin).or(n.whole.end.sub(s.whole.end)))))}asNumber(){return this.fmap(Yt)}_opIn(e,n){return this.fmap(n).appLeft(m(e))}_opOut(e,n){return this.fmap(n).appRight(m(e))}_opMix(e,n){return this.fmap(n).appBoth(m(e))}_opSqueeze(e,n){const s=m(e);return this.fmap(r=>s.fmap(o=>n(r)(o))).squeezeJoin()}_opSqueezeOut(e,n){const s=this;return m(e).fmap(o=>s.fmap(c=>n(c)(o))).squeezeJoin()}_opReset(e,n){return m(e).fmap(r=>this.fmap(o=>n(o)(r))).resetJoin()}_opRestart(e,n){return m(e).fmap(r=>this.fmap(o=>n(o)(r))).restartJoin()}_opPoly(e,n){const s=m(e);return this.fmap(r=>s.fmap(o=>n(o)(r))).polyJoin()}layer(...e){return E(...e.map(n=>n(this)))}superimpose(...e){return this.stack(...e.map(n=>n(this)))}stack(...e){return E(this,...e)}sequence(...e){return tt(this,...e)}seq(...e){return tt(this,...e)}cat(...e){return vt(this,...e)}fastcat(...e){return R(this,...e)}slowcat(...e){return rt(this,...e)}onTrigger(e,n=!0){return this.withHap(s=>s.setContext({...s.context,onTrigger:(...r)=>{s.context.onTrigger?.(...r),e(...r)},dominantTrigger:s.context.dominantTrigger||n}))}log(e=s=>`[hap] ${s.showWhole(!0)}`,n=s=>({hap:s})){return this.onTrigger((...s)=>{$(e(...s),void 0,n(...s))},!1)}logValues(e=n=>`[hap] ${ne(n,!0)}`){return this.log(n=>e(n.value))}drawLine(){return console.log(Xe(this)),this}unjoin(e,n=lt){return e.withHap(s=>s.withValue(r=>r?n(this.ribbon(s.whole.begin,s.whole.duration)):this))}into(e,n){return this.unjoin(e,n).innerJoin()}}function Jp(t,e){let n=[];return e.forEach(s=>{const r=n.findIndex(([o])=>t(s,o));r===-1?n.push([s]):n[r].push(s)}),n}const $p=(t,e)=>t.spanEquals(e);d.prototype.collect=function(){return this.withHaps(t=>Jp($p,t).map(e=>new T(e[0].whole,e[0].part,e,{})))};const Lp=f("arpWith",(t,e)=>e.collect().fmap(n=>m(t(n))).innerJoin().withHap(n=>new T(n.whole,n.part,n.value.value,n.combineContext(n.value)))),Rp=f("arp",(t,e)=>e.arpWith(n=>m(t).fmap(s=>n[s%n.length])),!1);function xt(t){return!Array.isArray(t)&&typeof t=="object"&&!Np(t)}function Wp(t,e,n){return xt(t)||xt(e)?(xt(t)||(t={value:t}),xt(e)||(e={value:e}),Pp(t,e,n)):n(t,e)}(function(){const t={set:[(n,s)=>s],keep:[n=>n],keepif:[(n,s)=>s?n:void 0],add:[D((n,s)=>n+s)],sub:[D((n,s)=>n-s)],mul:[D((n,s)=>n*s)],div:[D((n,s)=>n/s)],mod:[D(At)],pow:[D(Math.pow)],log2:[D(Math.log2)],band:[D((n,s)=>n&s)],bor:[D((n,s)=>n|s)],bxor:[D((n,s)=>n^s)],blshift:[D((n,s)=>n<<s)],brshift:[D((n,s)=>n>>s)],lt:[(n,s)=>n<s],gt:[(n,s)=>n>s],lte:[(n,s)=>n<=s],gte:[(n,s)=>n>=s],eq:[(n,s)=>n==s],eqt:[(n,s)=>n===s],ne:[(n,s)=>n!=s],net:[(n,s)=>n!==s],and:[(n,s)=>n&&s],or:[(n,s)=>n||s],func:[(n,s)=>s(n)]},e=["In","Out","Mix","Squeeze","SqueezeOut","Reset","Restart","Poly"];for(const[n,[s,r]]of Object.entries(t)){d.prototype["_"+n]=function(o){return this.fmap(c=>s(c,o))},Object.defineProperty(d.prototype,n,{get:function(){const o=this,c=(...u)=>o[n].in(...u);for(const u of e)c[u.toLowerCase()]=function(...a){var l=o;a=tt(a),r&&(l=r(l),a=r(a));var h;return n==="keepif"?(h=l["_op"+u](a,p=>k=>s(p,k)),h=h.removeUndefineds()):h=l["_op"+u](a,p=>k=>Wp(p,k,s)),h};return c.squeezein=c.squeeze,c}});for(const o of e)d.prototype[o.toLowerCase()]=function(...c){return this.set[o.toLowerCase()](c)}}d.prototype.struct=function(...n){return this.keepif.out(...n)},d.prototype.structAll=function(...n){return this.keep.out(...n)},d.prototype.mask=function(...n){return this.keepif.in(...n)},d.prototype.maskAll=function(...n){return this.keep.in(...n)},d.prototype.reset=function(...n){return this.keepif.reset(...n)},d.prototype.resetAll=function(...n){return this.keep.reset(...n)},d.prototype.restart=function(...n){return this.keepif.restart(...n)},d.prototype.restartAll=function(...n){return this.keep.restart(...n)}})();const Fp=E,Vp=E,Dp=Nt,dt=t=>new d(()=>[],t),S=dt(1),H=dt(0);function I(t){function e(s){return s.span.spanCycles.map(r=>new T(y(r.begin).wholeCycle(),r,t))}const n=new d(e,1);return n.__pure=t,n}function se(t){return t instanceof d||t?._Pattern}function m(t){return se(t)?t:Dt&&typeof t=="string"?Dt(t):I(t)}function Ye(t){let e=I([]);for(const n of t)e=e.bind(s=>n.fmap(r=>s.concat([r])));return e}function E(...t){t=t.map(s=>Array.isArray(s)?tt(...s):m(s));const e=s=>Y(t.map(r=>r.query(s))),n=new d(e);return G&&(n._steps=ut(...t.map(s=>s._steps))),n}function re(t,e){if(e=e.map(o=>Array.isArray(o)?tt(...o):m(o)),e.length===0)return S;if(e.length===1)return e[0];const[n,...s]=e.map(o=>o._steps),r=G?n.maximum(...s):void 0;return E(...t(r,e))}function tn(...t){return re((e,n)=>n.map(s=>s._steps.eq(e)?s:L(s,dt(e.sub(s._steps)))),t)}function en(...t){return re((e,n)=>n.map(s=>s._steps.eq(e)?s:L(dt(e.sub(s._steps)),s)),t)}function nn(...t){return re((e,n)=>n.map(s=>{if(s._steps.eq(e))return s;const r=dt(e.sub(s._steps).div(2));return L(r,s,r)}),t)}function Hp(t,...e){const[n,...s]=e.map(c=>c._steps),r=n.maximum(...s),o={centre:nn,left:tn,right:en,expand:E,repeat:(...c)=>Nt(...c).steps(r)};return t.inhabit(o).fmap(c=>c(...e)).innerJoin().setSteps(r)}function rt(...t){if(t=t.map(s=>Array.isArray(s)?R(...s):m(s)),t.length==1)return t[0];const e=function(s){const r=s.span,o=At(r.begin.sam(),t.length),c=t[o];if(!c)return[];const u=r.begin.floor().sub(r.begin.div(t.length).floor());return c.withHapTime(a=>a.add(u)).query(s.setSpan(r.withTime(a=>a.sub(u))))},n=G?ut(...t.map(s=>s._steps)):void 0;return new d(e).splitQueries().setSteps(n)}function oe(...t){t=t.map(m);const e=function(n){const s=Math.floor(n.span.begin)%t.length;return t[s]?.query(n)||[]};return new d(e).splitQueries()}function vt(...t){return rt(...t)}function Gp(...t){const e=t.reduce((n,[s])=>n+s,0);return t=t.map(([n,s])=>[n,s.fast(n)]),L(...t).slow(e)}function Qp(...t){let e=y(0);for(let n of t)n.length==2&&n.unshift(e),e=n[1];return E(...t.map(([n,s,r])=>I(m(r)).compress(y(n).div(e),y(s).div(e)))).slow(e).innerJoin()}function R(...t){let e=rt(...t);return t.length>1&&(e=e._fast(t.length),e._steps=t.length),t.length==1&&t[0].__steps_source&&(t._steps=t[0]._steps),e}function tt(...t){return R(...t)}function sn(...t){return R(...t)}function Ht(t){return Array.isArray(t)?t.length==0?[S,0]:t.length==1?Ht(t[0]):[R(...t.map(e=>Ht(e)[0])),t.length]:[m(t),1]}const Up=v((t,e)=>m(e).mask(t)),Kp=v((t,e)=>m(e).struct(t)),Zp=v((t,e)=>m(e).superimpose(...t)),Xp=v((t,e)=>m(e).withValue(t)),Yp=v((t,e)=>m(e).bind(t)),th=v((t,e)=>m(e).innerBind(t)),eh=v((t,e)=>m(e).outerBind(t)),nh=v((t,e)=>m(e).squeezeBind(t)),sh=v((t,e)=>m(e).stepBind(t)),rh=v((t,e)=>m(e).polyBind(t)),oh=v((t,e)=>m(e).set(t)),ih=v((t,e)=>m(e).keep(t)),ch=v((t,e)=>m(e).keepif(t)),uh=v((t,e)=>m(e).add(t)),ah=v((t,e)=>m(e).sub(t)),lh=v((t,e)=>m(e).mul(t)),fh=v((t,e)=>m(e).div(t)),ph=v((t,e)=>m(e).mod(t)),hh=v((t,e)=>m(e).pow(t)),dh=v((t,e)=>m(e).band(t)),mh=v((t,e)=>m(e).bor(t)),yh=v((t,e)=>m(e).bxor(t)),wh=v((t,e)=>m(e).blshift(t)),gh=v((t,e)=>m(e).brshift(t)),bh=v((t,e)=>m(e).lt(t)),_h=v((t,e)=>m(e).gt(t)),vh=v((t,e)=>m(e).lte(t)),kh=v((t,e)=>m(e).gte(t)),qh=v((t,e)=>m(e).eq(t)),Ah=v((t,e)=>m(e).eqt(t)),Sh=v((t,e)=>m(e).ne(t)),Bh=v((t,e)=>m(e).net(t)),Th=v((t,e)=>m(e).and(t)),Ch=v((t,e)=>m(e).or(t)),xh=v((t,e)=>m(e).func(t));function f(t,e,n=!0,s=!1,r=o=>o.innerJoin()){if(Array.isArray(t)){const u={};for(const a of t)u[a]=f(a,e,n,s,r);return u}const o=e.length;var c;return n?c=function(...u){u=u.map(m);const a=u[u.length-1];let l;if(o===1)l=e(a);else{const h=u.slice(0,-1);if(h.every(p=>p.__pure!=null)){const p=h.map(_=>_.__pure),k=h.filter(_=>_.__pure_loc).map(_=>_.__pure_loc);l=e(...p,a),l=l.withContext(_=>{const A=(_.locations||[]).concat(k);return{..._,locations:A}})}else{const[p,...k]=h;let _=(...A)=>e(...A,a);_=v(_,null,o-1),l=r(k.reduce((A,O)=>A.appLeft(O),p.fmap(_)))}}return s&&(l._steps=a._steps),l}:c=function(...u){u=u.map(m);const a=e(...u);return s&&(a._steps=u[u.length-1]._steps),a},d.prototype[t]=function(...u){if(o===2&&u.length!==1)u=[tt(...u)];else if(o!==u.length+1)throw new Error(`.${t}() expects ${o-1} inputs but got ${u.length}.`);return u=u.map(m),c(...u,this)},o>1&&(d.prototype["_"+t]=function(...u){const a=e(...u,this);return s&&a.setSteps(this._steps),a}),v(c,null,o)}function mt(t,e,n=!0,s=!1,r=o=>o.stepJoin()){return f(t,e,n,s,r)}const Oh=f("round",function(t){return t.asNumber().fmap(e=>Math.round(e))}),zh=f("floor",function(t){return t.asNumber().fmap(e=>Math.floor(e))}),Mh=f("ceil",function(t){return t.asNumber().fmap(e=>Math.ceil(e))}),Eh=f("toBipolar",function(t){return t.fmap(e=>e*2-1)}),Nh=f("fromBipolar",function(t){return t.fmap(e=>(e+1)/2)}),Ph=f("range",function(t,e,n){return n.mul(e-t).add(t)}),Ih=f("rangex",function(t,e,n){return n._range(Math.log(t),Math.log(e)).fmap(Math.exp)}),jh=f("range2",function(t,e,n){return n.fromBipolar()._range(t,e)}),Jh=f("ratio",t=>t.fmap(e=>Array.isArray(e)?e.slice(1).reduce((n,s)=>n/s,e[0]):e)),$h=f("compress",function(t,e,n){return t=y(t),e=y(e),t.gt(e)||t.gt(1)||e.gt(1)||t.lt(0)||e.lt(0)?S:n._fastGap(y(1).div(e.sub(t)))._late(t)}),{compressSpan:Lh,compressspan:Rh}=f(["compressSpan","compressspan"],function(t,e){return e._compress(t.begin,t.end)}),{fastGap:Wh,fastgap:Fh}=f(["fastGap","fastgap"],function(t,e){const n=function(r){const o=r.begin.sam(),c=r.begin.sub(o).mul(t).min(1),u=r.end.sub(o).mul(t).min(1);if(!(c>=1))return new M(o.add(c),o.add(u))},s=function(r){const o=r.part.begin,c=r.part.end,u=o.sam(),a=o.sub(u).div(t).min(1),l=c.sub(u).div(t).min(1),h=new M(u.add(a),u.add(l)),p=r.whole?new M(h.begin.sub(o.sub(r.whole.begin).div(t)),h.end.add(r.whole.end.sub(c).div(t))):void 0;return new T(p,h,r.value,r.context)};return e.withQuerySpanMaybe(n).withHap(s).splitQueries()}),Vh=f("focus",function(t,e,n){return t=y(t),e=y(e),n._early(t.sam())._fast(y(1).div(e.sub(t)))._late(t)}),{focusSpan:Dh,focusspan:Hh}=f(["focusSpan","focusspan"],function(t,e){return e._focus(t.begin,t.end)}),Gh=f("ply",function(t,e){const n=e.fmap(s=>I(s)._fast(t)).squeezeJoin();return G&&(n._steps=y(t).mulmaybe(e._steps)),n}),{fast:Qh,density:Bw}=f(["fast","density"],function(t,e){return t===0?S:(t=y(t),e.withQueryTime(s=>s.mul(t)).withHapTime(s=>s.div(t)).setSteps(e._steps))},!0,!0),Uh=f("hurry",function(t,e){return e._fast(t).mul(I({speed:t}))}),{slow:Kh,sparsity:Zh}=f(["slow","sparsity"],function(t,e){return t===0?S:e._fast(y(1).div(t))}),Xh=f("inside",function(t,e,n){return e(n._slow(t))._fast(t)}),Yh=f("outside",function(t,e,n){return e(n._fast(t))._slow(t)}),td=f("lastOf",function(t,e,n){const s=Array(t-1).fill(n);return s.push(e(n)),oe(...s)}),{firstOf:ed,every:nd}=f(["firstOf","every"],function(t,e,n){const s=Array(t-1).fill(n);return s.unshift(e(n)),oe(...s)}),sd=f("apply",function(t,e){return t(e)}),rd=f("cpm",function(t,e){return e._fast(t/60/1)}),od=f("early",function(t,e){return t=y(t),e.withQueryTime(n=>n.add(t)).withHapTime(n=>n.sub(t))},!0,!0),rn=f("late",function(t,e){return t=y(t),e._early(y(0).sub(t))},!0,!0),id=f("zoom",function(t,e,n){if(e=y(e),t=y(t),t.gte(e))return H;const s=e.sub(t),r=G?n._steps?.mulmaybe(s):void 0;return n.withQuerySpan(o=>o.withCycle(c=>c.mul(s).add(t))).withHapSpan(o=>o.withCycle(c=>c.sub(t).div(s))).splitQueries().setSteps(r)}),{zoomArc:cd,zoomarc:ud}=f(["zoomArc","zoomarc"],function(t,e){return e.zoom(t.begin,t.end)}),ad=f("bite",(t,e,n)=>e.fmap(s=>r=>{const o=y(s).div(r).mod(1),c=o.add(y(1).div(r));return n.zoom(o,c)}).appLeft(t).squeezeJoin(),!1),ld=f("linger",function(t,e){return t==0?S:t<0?e._zoom(t.add(1),1)._slow(t):e._zoom(0,t)._slow(t)},!0,!0),{segment:fd,seg:pd}=f(["segment","seg"],function(t,e){return e.struct(I(!0)._fast(t)).setSteps(t)}),hd=f("swingBy",(t,e,n)=>n.inside(e,rn(sn(0,t/2)))),dd=f("swing",(t,e)=>e.swingBy(1/3,t)),{invert:md,inv:yd}=f(["invert","inv"],function(t){return t.fmap(e=>!e)},!0,!0),wd=f("when",function(t,e,n){return t?e(n):n}),gd=f("off",function(t,e,n){return E(n,e(n.late(t)))}),bd=f("brak",function(t){return t.when(rt(!1,!0),e=>R(e,S)._late(.25))}),on=f("rev",function(t){const e=function(n){const s=n.span,r=s.begin.sam(),o=s.begin.nextSam(),c=function(a){const l=a.withTime(p=>r.add(o.sub(p))),h=l.begin;return l.begin=l.end,l.end=h,l};return t.query(n.setSpan(c(s))).map(a=>a.withSpan(c))};return new d(e).splitQueries()},!1,!0),_d=f("revv",function(t){const e=n=>new M(y(0).sub(n.end),y(0).sub(n.begin));return t.withQuerySpan(e).withHapSpan(e)}),vd=f("pressBy",function(t,e){return e.fmap(n=>I(n).compress(t,1)).squeezeJoin()}),kd=f("press",function(t){return t._pressBy(.5)});d.prototype.hush=function(){return S};const qd=f("palindrome",function(t){return t.lastOf(2,on)},!0,!0),{juxBy:Ad,juxby:Sd}=f(["juxBy","juxby"],function(t,e,n){t/=2;const s=function(c,u,a){return u in c?c[u]:a},r=n.withValue(c=>Object.assign({},c,{pan:s(c,"pan",.5)-t})),o=e(n.withValue(c=>Object.assign({},c,{pan:s(c,"pan",.5)+t})));return E(r,o).setSteps(G?ut(r._steps,o._steps):void 0)}),Bd=f("jux",function(t,e){return e._juxBy(1,t,e)}),{echoWith:Td,echowith:Cd,stutWith:xd,stutwith:Od}=f(["echoWith","echowith","stutWith","stutwith"],function(t,e,n,s){return E(...St(0,t-1).map(r=>n(s.late(y(e).mul(r)),r)))}),zd=f("echo",function(t,e,n,s){return s._echoWith(t,e,(r,o)=>r.gain(Math.pow(n,o)))}),Md=f("stut",function(t,e,n,s){return s._echoWith(t,n,(r,o)=>r.gain(Math.pow(e,o)))}),cn=f("applyN",function(t,e,n){let s=n;for(let r=0;r<t;r++)s=e(s);return s}),Ed=f(["plyWith","plywith"],function(t,e,n){const s=n.fmap(r=>vt(...St(0,t-1).map(o=>cn(o,e,r)))._fast(t)).squeezeJoin();return G&&(s._steps=y(t).mulmaybe(n._steps)),s}),Nd=f(["plyForEach","plyforeach"],function(t,e,n){const s=n.fmap(r=>vt(vt(I(r),...St(1,t-1).map(o=>e(I(r),o))))._fast(t)).squeezeJoin();return G&&(s._steps=y(t).mulmaybe(n._steps)),s}),ie=function(t,e,n=!1){return t=y(t),rt(...St(0,t.sub(1)).map(s=>n?e.late(y(s).div(t)):e.early(y(s).div(t))))},Pd=f("iter",function(t,e){return ie(t,e,!1)},!0,!0),{iterBack:Id,iterback:jd}=f(["iterBack","iterback"],function(t,e){return ie(t,e,!0)},!0,!0),{repeatCycles:Jd}=f("repeatCycles",function(t,e){return new d(function(n){const s=n.span.begin.sam(),r=s.div(t).sam(),o=s.sub(r);return n=n.withSpan(c=>c.withTime(u=>u.sub(o))),e.query(n).map(c=>c.withSpan(u=>u.withTime(a=>a.add(o))))}).splitQueries()},!0,!0),ce=function(t,e,n,s=!1,r=!1){const o=Array(t-1).fill(!1);o.unshift(!0);const c=ie(t,tt(...o),!s);return r||(n=n.repeatCycles(t)),n.when(c,e)},{chunk:$d,slowchunk:Ld,slowChunk:Rd}=f(["chunk","slowchunk","slowChunk"],function(t,e,n){return ce(t,e,n,!1,!1)},!0,!0),{chunkBack:Wd,chunkback:Fd}=f(["chunkBack","chunkback"],function(t,e,n){return ce(t,e,n,!0)},!0,!0),{fastchunk:Vd,fastChunk:Dd}=f(["fastchunk","fastChunk"],function(t,e,n){return ce(t,e,n,!1,!0)},!0,!0),{chunkinto:Hd,chunkInto:Gd}=f(["chunkinto","chunkInto"],function(t,e,n){return n.into(R(!0,...Array(t-1).fill(!1))._iterback(t),e)}),{chunkbackinto:Qd,chunkBackInto:Ud}=f(["chunkbackinto","chunkBackInto"],function(t,e,n){return n.into(R(!0,...Array(t-1).fill(!1))._iter(t)._early(1),e)}),Kd=f("bypass",function(t,e){return t=!!parseInt(t),t?S:e},!0,!0),{ribbon:Zd,rib:Xd}=f(["ribbon","rib"],(t,e,n)=>n.early(t).restart(I(1).slow(e))),Yd=f("hsla",(t,e,n,s,r)=>r.color(`hsla(${t}turn,${e*100}%,${n*100}%,${s})`)),tm=f("hsl",(t,e,n,s)=>s.color(`hsl(${t}turn,${e*100}%,${n*100}%)`));d.prototype.tag=function(t){return this.withContext(e=>({...e,tags:(e.tags||[]).concat([t])}))};const em=f("filter",(t,e)=>e.withHaps(n=>n.filter(t))),nm=f("filterWhen",(t,e)=>e.filter(n=>t(n.whole.begin))),sm=f("within",(t,e,n,s)=>E(n(s.filterWhen(r=>r.cyclePos()>=t&&r.cyclePos()<=e)),s.filterWhen(r=>r.cyclePos()<t||r.cyclePos()>e)));d.prototype.stepJoin=function(){const t=this,e=L(...Gt(Qt(t.queryArc(0,1))))._steps,n=function(s){const o=t.early(s.span.begin.sam()).query(s.setSpan(new M(y(0),y(1))));return L(...Gt(Qt(o))).query(s)};return new d(n,e)};d.prototype.stepBind=function(t){return this.fmap(t).stepJoin()};function Gt(t){const e=t.filter((o,c)=>c.hasSteps).reduce((o,c)=>o.add(c),y(0)),n=ht(t.map((o,c)=>c._steps)).reduce((o,c)=>o.add(c),y(0)),s=e.eq(0)?void 0:n.div(e);function r(o,c){return c._steps===void 0?[o.mulmaybe(s),c]:[c._steps,c]}return t.map(o=>r(...o))}function Qt(t){const e=Y(t.map(r=>[r.part.begin,r.part.end])),n=De([y(0),y(1),...e]);return Fe(n).map(r=>[r[1].sub(r[0]),E(...un(new M(...r),t).map(o=>o.value.withHap(c=>c.setContext(c.combineContext(o)))))])}function un(t,e){return ht(e.map(n=>an(t,n)))}function an(t,e){const n=t.intersection(e.part);if(n!=null)return new T(e.whole,n,e.value,e.context)}const ln=f("pace",function(t,e){return e._steps===void 0?e:e._steps.eq(y(0))?H:e._fast(y(t).div(e._steps)).setSteps(t)});function fn(t,...e){const n=e.map(r=>Ht(r));if(n.length==0)return S;t==0&&(t=n[0][1]);const s=[];for(const r of n)r[1]!=0&&(t==r[1]?s.push(r[0]):s.push(r[0]._fast(y(t).div(y(r[1])))));return E(...s)}function Nt(...t){if(Array.isArray(t[0]))return fn(0,...t);if(t=t.filter(s=>s.hasSteps),t.length==0)return S;const e=ut(...t.map(s=>s._steps));if(e.eq(y(0)))return H;const n=E(...t.map(s=>s.pace(e)));return n._steps=e,n}function L(...t){if(t.length===0)return H;const e=c=>Array.isArray(c)?c:[c._steps??1,c];if(t=t.map(e),t.find(c=>c[0]===void 0)){const c=t.map(a=>a[0]).filter(a=>a!==void 0);if(c.length===0)return R(...t.map(a=>a[1]));if(c.length===t.length)return H;const u=c.reduce((a,l)=>a.add(l),y(0)).div(c.length);for(let a of t)a[0]===void 0&&(a[0]=u)}if(t.length==1)return m(t[0][1]).withSteps(u=>t[0][0]);const n=t.map(c=>c[0]).reduce((c,u)=>c.add(u),y(0));let s=y(0);const r=[];for(const[c,u]of t){if(y(c).eq(0))continue;const a=s.add(c);r.push(m(u)._compress(s.div(n),a.div(n))),s=a}const o=E(...r);return o._steps=n,o}function pn(...t){t=t.map(r=>Array.isArray(r)?r.map(m):[m(r)]);const e=ut(...t.map(r=>y(r.length)));let n=[];for(let r=0;r<e;++r)n.push(...t.map(o=>o.length==0?S:o[r%o.length]));n=n.filter(r=>r.hasSteps&&r._steps>0);const s=n.reduce((r,o)=>r.add(o._steps),y(0));return n=L(...n),n._steps=s,n}const hn=mt("take",function(t,e){if(!e.hasSteps||e._steps.lte(0)||(t=y(t),t.eq(0)))return H;const n=t<0;n&&(t=t.abs());const s=t.div(e._steps);return s.lte(0)?H:s.gte(1)?e:n?e.zoom(y(1).sub(s),1):e.zoom(0,s)}),dn=mt("drop",function(t,e){return e.hasSteps?(t=y(t),t.lt(0)?e.take(e._steps.add(t)):e.take(y(0).sub(e._steps.sub(t)))):H}),mn=mt("extend",function(t,e){return e.fast(t).expand(t)}),rm=mt("replicate",function(t,e){return e.repeatCycles(t).fast(t).expand(t)}),yn=mt("expand",function(t,e){return e.withSteps(n=>n.mul(y(t)))}),wn=mt("contract",function(t,e){return e.withSteps(n=>n.div(y(t)))});d.prototype.shrinklist=function(t){const e=this;if(!e.hasSteps)return[e];let[n,s]=Array.isArray(t)?t:[t,e._steps];if(n=y(n),s===0||n===0)return[e];const r=n>0,o=[];if(r){const c=y(1).div(e._steps).mul(n);for(let u=0;u<s;++u){const a=c.mul(u);if(a.gt(1))break;o.push([a,1])}}else{n=y(0).sub(n);const c=y(1).div(e._steps).mul(n);for(let u=0;u<s;++u){const a=y(1).sub(c.mul(u));if(a.lt(0))break;o.push([y(0),a])}}return o.map(c=>e.zoom(...c))};const gn=(t,e)=>e.shrinklist(t),bn=f("shrink",function(t,e){if(!e.hasSteps)return H;const n=e.shrinklist(t),s=L(...n);return s._steps=n.reduce((r,o)=>r.add(o._steps),y(0)),s},!0,!1,t=>t.stepJoin()),om=f("grow",function(t,e){if(!e.hasSteps)return H;const n=e.shrinklist(y(0).sub(t));n.reverse();const s=L(...n);return s._steps=n.reduce((r,o)=>r.add(o._steps),y(0)),s},!0,!1,t=>t.stepJoin()),_n=function(t,...e){return t.tour(...e)};d.prototype.tour=function(...t){return L(...[].concat(...t.map((e,n)=>[...t.slice(0,t.length-n),this,...t.slice(t.length-n)]),this,...t))};const vn=function(...t){t=t.filter(s=>s.hasSteps);const e=rt(...t.map(s=>s._slow(s._steps))),n=ut(...t.map(s=>s._steps));return e._fast(n).setSteps(n)},im=L,kn=L,cm=L,um=pn,am=Nt;d.prototype.s_polymeter=d.prototype.polymeter;const lm=bn;d.prototype.s_taper=d.prototype.shrink;const fm=gn;d.prototype.s_taperlist=d.prototype.shrinklist;const pm=hn;d.prototype.s_add=d.prototype.take;const hm=dn;d.prototype.s_sub=d.prototype.drop;const dm=yn;d.prototype.s_expand=d.prototype.expand;const mm=mn;d.prototype.s_extend=d.prototype.extend;const ym=wn;d.prototype.s_contract=d.prototype.contract;const wm=_n;d.prototype.s_tour=d.prototype.tour;const gm=vn;d.prototype.s_zip=d.prototype.zip;const bm=ln;d.prototype.steps=d.prototype.pace;const _m=f("chop",function(t,e){const s=Array.from({length:t},(c,u)=>u).map(c=>({begin:c/t,end:(c+1)/t})),r=function(c,u){if("begin"in c&&"end"in c&&c.begin!==void 0&&c.end!==void 0){const a=c.end-c.begin;u={begin:c.begin+u.begin*a,end:c.begin+u.end*a}}return Object.assign({},c,u)},o=function(c){return tt(s.map(u=>r(c,u)))};return e.squeezeBind(o).setSteps(G?y(t).mulmaybe(e._steps):void 0)}),vm=f("striate",function(t,e){const s=Array.from({length:t},(o,c)=>c).map(o=>({begin:o/t,end:(o+1)/t})),r=rt(...s);return e.set(r)._fast(t).setSteps(G?y(t).mulmaybe(e._steps):void 0)}),qn=function(t,e,n=.5){return e.speed(1/t*n).unit("c").slow(t)},An=f("slice",function(t,e,n){return t.innerBind(s=>e.outerBind(r=>n.outerBind(o=>{o=o instanceof Object?o:{s:o};const c=Array.isArray(s)?s[r]:r/s,u=Array.isArray(s)?s[r+1]:(r+1)/s;return I({begin:c,end:u,_slices:s,...o})}))).setSteps(e._steps)},!1);d.prototype.onTriggerTime=function(t){return this.onTrigger((e,n,s,r)=>{const o=r-n;window.setTimeout(()=>{t(e)},o*1e3)},!1)};const km=f("splice",function(t,e,n){const s=An(t,e,n);return new d(r=>{const o=r.controls._cps||1;return s.query(r).map(u=>u.withValue(a=>({speed:o/a._slices/u.whole.duration*(a.speed||1),unit:"c",...a})))}).setSteps(e._steps)},!1),{loopAt:qm,loopat:Am}=f(["loopAt","loopat"],function(t,e){const n=e._steps?e._steps.div(t):void 0;return new d(s=>qn(t,e,s.controls._cps).query(s),n)}),Sm=f("fit",t=>t.withHaps((e,n)=>e.map(s=>s.withValue(r=>{const o=("end"in r?r.end:1)-("begin"in r?r.begin:0);return{...r,speed:(n.controls._cps||1)/s.whole.duration*o,unit:"c"}})))),{loopAtCps:Bm,loopatcps:Tm}=f(["loopAtCps","loopatcps"],function(t,e,n){return qn(t,n,e)}),Cm=t=>I(1).withValue(()=>m(t())).innerJoin();let Oe=t=>t<.5?1:1-(t-.5)/.5,Sn=(t,e,n)=>{e=m(e),t=m(t),n=m(n);let s=e.fmap(o=>({gain:Oe(o)})),r=e.fmap(o=>({gain:Oe(1-o)}));return E(t.mul(s),n.mul(r))};d.prototype.xfade=function(t,e){return Sn(this,t,e)};const xm=t=>(e,n,s)=>{e=y(e).mod(n),n=y(n);const r=e.div(n),o=e.add(1).div(n);return t(s.fmap(c=>I(c)._compress(r,o)))},{beat:Om}=f(["beat"],xm(t=>t.innerJoin())),ue=(t,e,n)=>{n=y(n);const s=y(1).div(t.length),r=u=>{const a=[];for(const[l,h]of u.entries())h&&a.push([y(l).div(u.length),h]);return a},o=Et(([u,a],[l,h])=>{const p=n.mul(l-u).add(u),k=p.add(s);return new M(p,k)},r(t),r(e));function c(u){const a=u.span.begin.sam(),l=u.span.cycleArc(),h=[];for(const p of o){const k=p.intersection(l);k!==void 0&&h.push(new T(p.withTime(_=>_.add(a)),k.withTime(_=>_.add(a)),!0))}return h}return new d(c).splitQueries()},zm=(t,e,n)=>(t=m(t),e=m(e),n=m(n),t.innerBind(s=>e.innerBind(r=>n.innerBind(o=>ue(s,r,o))))),Mm=["scurve","soft","hard","cubic","diode","asym","fold","sinefold","chebyshev"];for(const t of Mm)d.prototype[t]=function(e){const n=m(e).fmap(s=>Array.isArray(s)?[...s,t]:[s,1,t]);return this.distort(n)};const Bn=t=>{let n=I(v((...s)=>s,null,t.length));for(const s of t)n=n.appBoth(m(s));return n},Pt=t=>Array.isArray(t)?Bn(t):m(t);d.prototype.partials=function(t){return this.withValue(e=>n=>({...e,partials:n})).appLeft(Pt(t))};const Em=t=>Pt(t).as("partials");d.prototype.phases=function(t){return this.withValue(e=>n=>({...e,phases:n})).appLeft(Pt(t))};const Nm=t=>Pt(t).as("phases");function It(t){let e=Array.isArray(t);t=e?t:[t];const n=t[0],s=o=>{let c;if(typeof o=="object"&&o.value!==void 0&&(c={...o},o=o.value,delete c.value),e&&Array.isArray(o)){const u=c||{};return o.forEach((a,l)=>{l<t.length&&(u[t[l]]=a)}),u}else return c?(c[n]=o,c):{[n]:o}},r=function(o,c){return c?typeof o>"u"?c.fmap(s):c.set(m(o).withValue(s)):m(o).withValue(s)};return d.prototype[n]=function(o){return r(o,this)},r}const kt=new Map;function Tn(t){return kt.has(t)}function i(t,...e){const n=Array.isArray(t)?t[0]:t;let s={};return s[n]=It(t),kt.set(n,n),e.forEach(r=>{s[r]=s[n],kt.set(r,n),d.prototype[r]=d.prototype[n]}),s}function K(t,e,...n){t=Array.isArray(t)?t:[t];let s={};for(let r=1;r<=e;r++){let o=[...n],c=[...t];if(r===1){const a=o.map(h=>`${h}1`),l=c.map(h=>`${h}1`);o=o.concat(a).concat(l)}else o=o.map(a=>`${a}${r}`),c=c.map(a=>`${a}${r}`);const u=i(c,...o);s={...s,...u}}return s}const{s:Cn,sound:xn}=i(["s","n","gain"],"sound"),{wt:On,wavetablePosition:zn}=i("wt","wavetablePosition"),{wtenv:Mn}=i("wtenv"),{wtattack:En,wtatt:Nn}=i("wtattack","wtatt"),{wtdecay:Pn,wtdec:In}=i("wtdecay","wtdec"),{wtsustain:jn,wtsus:Jn}=i("wtsustain","wtsus"),{wtrelease:$n,wtrel:Ln}=i("wtrelease","wtrel"),{wtrate:Rn}=i("wtrate"),{wtsync:Wn}=i("wtsync"),{wtdepth:Fn}=i("wtdepth"),{wtshape:Vn}=i("wtshape"),{wtdc:Dn}=i("wtdc"),{wtskew:Hn}=i("wtskew"),{warp:Gn,wavetableWarp:Qn}=i("warp","wavetableWarp"),{warpattack:Un,warpatt:Kn}=i("warpattack","warpatt"),{warpdecay:Zn,warpdec:Xn}=i("warpdecay","warpdec"),{warpsustain:Yn,warpsus:ts}=i("warpsustain","warpsus"),{warprelease:es,warprel:ns}=i("warprelease","warprel"),{warprate:ss}=i("warprate"),{warpdepth:rs}=i("warpdepth"),{warpshape:os}=i("warpshape"),{warpdc:is}=i("warpdc"),{warpskew:cs}=i("warpskew"),{warpmode:us,wavetableWarpMode:as}=i("warpmode","wavetableWarpMode"),{wtphaserand:ls,wavetablePhaseRand:fs}=i("wtphaserand","wavetablePhaseRand"),{warpenv:ps}=i("warpenv"),{warpsync:hs}=i("warpsync"),{source:ds,src:ms}=i("source","src"),{n:ys}=i("n"),{note:ws}=i(["note","n"]),{accelerate:gs}=i("accelerate"),{velocity:bs,vel:_s}=i("velocity","vel"),{gain:vs}=i("gain"),{postgain:ks}=i("postgain"),{amp:qs}=i("amp"),{attack:As,att:Ss}=i("attack","att"),{fmh:Bs,fmh1:Ts,fmh2:Cs,fmh3:xs,fmh4:Os,fmh5:zs,fmh6:Ms,fmh7:Es,fmh8:Ns}=K(["fmh","fmi"],8,"fmh"),{fmi:Ps,fmi1:Is,fmi2:js,fmi3:Js,fmi4:$s,fmi5:Ls,fmi6:Rs,fmi7:Ws,fmi8:Fs,fm:Vs,fm1:Ds,fm2:Hs,fm3:Gs,fm4:Qs,fm5:Us,fm6:Ks,fm7:Zs,fm8:Xs}=K(["fmi","fmh"],8,"fm"),{fmenv:Ys,fmenv1:tr,fmenv2:er,fmenv3:nr,fmenv4:sr,fmenv5:rr,fmenv6:or,fmenv7:ir,fmenv8:cr}=K("fmenv",8),{fmattack:ur,fmattack1:ar,fmattack2:lr,fmattack3:fr,fmattack4:pr,fmattack5:hr,fmattack6:dr,fmattack7:mr,fmattack8:yr,fmatt:wr,fmatt1:gr,fmatt2:br,fmatt3:_r,fmatt4:vr,fmatt5:kr,fmatt6:qr,fmatt7:Ar,fmatt8:Sr}=K("fmattack",8,"fmatt"),{fmwave:Br,fmwave1:Tr,fmwave2:Cr,fmwave3:xr,fmwave4:Or,fmwave5:zr,fmwave6:Mr,fmwave7:Er,fmwave8:Nr}=K("fmwave",8),{fmdecay:Pr,fmdecay1:Ir,fmdecay2:jr,fmdecay3:Jr,fmdecay4:$r,fmdecay5:Lr,fmdecay6:Rr,fmdecay7:Wr,fmdecay8:Fr,fmdec:Vr,fmdec1:Dr,fmdec2:Hr,fmdec3:Gr,fmdec4:Qr,fmdec5:Ur,fmdec6:Kr,fmdec7:Zr,fmdec8:Xr}=K("fmdecay",8,"fmdec"),{fmsustain:Yr,fmsustain1:to,fmsustain2:eo,fmsustain3:no,fmsustain4:so,fmsustain5:ro,fmsustain6:oo,fmsustain7:io,fmsustain8:co,fmsus:uo,fmsus1:ao,fmsus2:lo,fmsus3:fo,fmsus4:po,fmsus5:ho,fmsus6:mo,fmsus7:yo,fmsus8:wo}=K("fmsustain",8,"fmsus"),{fmrelease:go,fmrelease1:bo,fmrelease2:_o,fmrelease3:vo,fmrelease4:ko,fmrelease5:qo,fmrelease6:Ao,fmrelease7:So,fmrelease8:Bo,fmrel:To,fmrel1:Co,fmrel2:xo,fmrel3:Oo,fmrel4:zo,fmrel5:Mo,fmrel6:Eo,fmrel7:No,fmrel8:Po}=K("fmrelease",8,"fmrel");for(let t=0;t<=8;t++)for(let e=0;e<=8;e++)i(`fmi${t}${e}`,`fm${t}${e}`);const{bank:Io}=i("bank"),{chorus:jo}=i("chorus"),{analyze:Jo}=i("analyze"),{fft:$o}=i("fft"),{decay:Lo,dec:Ro}=i("decay","dec"),{sustain:Wo,sus:Fo}=i("sustain","sus"),{release:Vo,rel:Do}=i("release","rel"),{hold:Ho}=i("hold"),{bandf:Go,bpf:Qo,bp:Uo}=i(["bandf","bandq","bpenv"],"bpf","bp"),{bandq:Ko,bpq:Zo}=i("bandq","bpq"),{begin:Xo}=i("begin"),{end:Yo}=i("end"),{loop:ti}=i("loop"),{loopBegin:ei,loopb:ni}=i("loopBegin","loopb"),{loopEnd:si,loope:ri}=i("loopEnd","loope"),{crush:oi}=i("crush"),{coarse:ii}=i("coarse"),{tremolo:ci}=i(["tremolo","tremolodepth","tremoloskew","tremolophase"],"trem"),{tremolosync:ui}=i(["tremolosync","tremolodepth","tremoloskew","tremolophase"],"tremsync"),{tremolodepth:ai}=i("tremolodepth","tremdepth"),{tremoloskew:li}=i("tremoloskew","tremskew"),{tremolophase:fi}=i("tremolophase","tremphase"),{tremoloshape:pi}=i("tremoloshape","tremshape"),{drive:hi}=i("drive"),{duck:di}=i("duckorbit","duck"),{duckdepth:mi}=i("duckdepth"),{duckonset:yi}=i("duckonset","duckons"),{duckattack:wi}=i("duckattack","duckatt"),{byteBeatExpression:gi,bbexpr:bi}=i("byteBeatExpression","bbexpr"),{byteBeatStartTime:_i,bbst:vi}=i("byteBeatStartTime","bbst"),{channels:ki,ch:qi}=i("channels","ch"),{pw:Ai}=i(["pw","pwrate","pwsweep"]),{pwrate:Si}=i("pwrate"),{pwsweep:Bi}=i("pwsweep"),{phaserrate:Ti,ph:Ci,phaser:xi}=i(["phaserrate","phaserdepth","phasercenter","phasersweep"],"ph","phaser"),{phasersweep:Oi,phs:zi}=i("phasersweep","phs"),{phasercenter:Mi,phc:Ei}=i("phasercenter","phc"),{phaserdepth:Ni,phd:Pi,phasdp:Ii}=i("phaserdepth","phd","phasdp"),{channel:ji}=i("channel"),{cut:Ji}=i("cut"),{cutoff:$i,ctf:Li,lpf:Ri,lp:Wi}=i(["cutoff","resonance","lpenv"],"ctf","lpf","lp"),{lpenv:Fi,lpe:Vi}=i("lpenv","lpe"),{hpenv:Di,hpe:Hi}=i("hpenv","hpe"),{bpenv:Gi,bpe:Qi}=i("bpenv","bpe"),{lpattack:Ui,lpa:Ki}=i("lpattack","lpa"),{hpattack:Zi,hpa:Xi}=i("hpattack","hpa"),{bpattack:Yi,bpa:tc}=i("bpattack","bpa"),{lpdecay:ec,lpd:nc}=i("lpdecay","lpd"),{hpdecay:sc,hpd:rc}=i("hpdecay","hpd"),{bpdecay:oc,bpd:ic}=i("bpdecay","bpd"),{lpsustain:cc,lps:uc}=i("lpsustain","lps"),{hpsustain:ac,hps:lc}=i("hpsustain","hps"),{bpsustain:fc,bps:pc}=i("bpsustain","bps"),{lprelease:hc,lpr:dc}=i("lprelease","lpr"),{hprelease:mc,hpr:yc}=i("hprelease","hpr"),{bprelease:wc,bpr:gc}=i("bprelease","bpr"),{ftype:bc}=i("ftype"),{fanchor:_c}=i("fanchor"),{lprate:vc}=i("lprate"),{lpsync:kc}=i("lpsync"),{lpdepth:qc}=i("lpdepth"),{lpdepthfrequency:Ac,lpdepthfreq:Sc}=i("lpdepthfrequency","lpdepthfreq"),{lpshape:Bc}=i("lpshape"),{lpdc:Tc}=i("lpdc"),{lpskew:Cc}=i("lpskew"),{bprate:xc}=i("bprate"),{bpsync:Oc}=i("bpsync"),{bpdepth:zc}=i("bpdepth"),{bpdepthfrequency:Mc,bpdepthfreq:Ec}=i("bpdepthfrequency","bpdepthfreq"),{bpshape:Nc}=i("bpshape"),{bpdc:Pc}=i("bpdc"),{bpskew:Ic}=i("bpskew"),{hprate:jc}=i("hprate"),{hpsync:Jc}=i("hpsync"),{hpdepth:$c}=i("hpdepth"),{hpdepthfrequency:Lc,hpdepthfreq:Rc}=i("hpdepthfrequency","hpdepthfreq"),{hpshape:Wc}=i("hpshape"),{hpdc:Fc}=i("hpdc"),{hpskew:Vc}=i("hpskew"),{vib:Dc,vibrato:Hc,v:Gc}=i(["vib","vibmod"],"vibrato","v"),{noise:Qc}=i("noise"),{vibmod:Uc,vmod:Kc}=i(["vibmod","vib"],"vmod"),{hcutoff:Zc,hpf:Xc,hp:Yc}=i(["hcutoff","hresonance","hpenv"],"hpf","hp"),{hresonance:tu,hpq:eu}=i("hresonance","hpq"),{resonance:nu,lpq:su}=i("resonance","lpq"),{djf:ru}=i("djf"),{delay:ou}=i(["delay","delaytime","delayfeedback"]),{delayfeedback:iu,delayfb:cu,dfb:uu}=i("delayfeedback","delayfb","dfb"),{delayspeed:au}=i("delayspeed"),{delaytime:lu,delayt:fu,dt:pu}=i("delaytime","delayt","dt"),{delaysync:hu}=i("delaysync"),{lock:du}=i("lock"),{detune:mu,det:yu}=i("detune","det"),{unison:wu}=i("unison"),{spread:gu}=i("spread"),{dry:bu}=i("dry"),{fadeTime:_u,fadeOutTime:vu}=i("fadeTime","fadeOutTime"),{fadeInTime:ku}=i("fadeInTime"),{freq:qu}=i("freq"),{pattack:Au,patt:Su}=i("pattack","patt"),{pdecay:Bu,pdec:Tu}=i("pdecay","pdec"),{psustain:Cu,psus:xu}=i("psustain","psus"),{prelease:Ou,prel:zu}=i("prelease","prel"),{penv:Mu}=i("penv"),{pcurve:Eu}=i("pcurve"),{panchor:Nu}=i("panchor"),{gate:Pu,gat:Iu}=i("gate","gat"),{leslie:ju}=i("leslie"),{lrate:Ju}=i("lrate"),{lsize:$u}=i("lsize"),{activeLabel:Lu}=i("activeLabel"),{label:Ru}=i(["label","activeLabel"]),{degree:Wu}=i("degree"),{mtranspose:Fu}=i("mtranspose"),{ctranspose:Vu}=i("ctranspose"),{harmonic:Du}=i("harmonic"),{stepsPerOctave:Hu}=i("stepsPerOctave"),{octaveR:Gu}=i("octaveR"),{nudge:Qu}=i("nudge"),{octave:Uu,oct:Ku}=i("octave","oct"),{orbit:Zu}=i("orbit","o"),{overgain:Xu}=i("overgain"),{overshape:Yu}=i("overshape"),{pan:ta}=i("pan"),{panspan:ea}=i("panspan"),{pansplay:na}=i("pansplay"),{panwidth:sa}=i("panwidth"),{panorient:ra}=i("panorient"),{rate:oa}=i("rate"),{slide:ia}=i("slide"),{semitone:ca}=i("semitone"),{voice:ua}=i("voice"),{chord:aa}=i("chord"),{dictionary:la,dict:fa}=i("dictionary","dict"),{anchor:pa}=i("anchor"),{offset:ha}=i("offset"),{octaves:da}=i("octaves"),{mode:ma}=i(["mode","anchor"]),{room:ya}=i(["room","size"]),{roomlp:wa,rlp:ga}=i("roomlp","rlp"),{roomdim:ba,rdim:_a}=i("roomdim","rdim"),{roomfade:va,rfade:ka}=i("roomfade","rfade"),{ir:qa,iresponse:Aa}=i(["ir","i"],"iresponse"),{irspeed:Sa}=i("irspeed"),{irbegin:Ba}=i("irbegin"),{roomsize:Ta,size:Ca,sz:xa,rsize:Oa}=i("roomsize","size","sz","rsize"),{shape:za}=i(["shape","shapevol"]),{distort:Ma,dist:Ea}=i(["distort","distortvol","distorttype"],"dist"),{distortvol:Na}=i("distortvol","distvol"),{distorttype:Pa}=i("distorttype","disttype"),{compressor:Ia}=i(["compressor","compressorRatio","compressorKnee","compressorAttack","compressorRelease"]),{compressorKnee:ja}=i("compressorKnee"),{compressorRatio:Ja}=i("compressorRatio"),{compressorAttack:$a}=i("compressorAttack"),{compressorRelease:La}=i("compressorRelease"),{speed:ae}=i("speed"),{stretch:Ra}=i("stretch"),{unit:Wa}=i("unit"),{squiz:Fa}=i("squiz"),{vowel:Va}=i("vowel"),{waveloss:Da}=i("waveloss"),{density:Pm}=i("density"),{expression:Ha}=i("expression"),{sustainpedal:Ga}=i("sustainpedal"),{fshift:Qa}=i("fshift"),{fshiftnote:Ua}=i("fshiftnote"),{fshiftphase:Ka}=i("fshiftphase"),{triode:Za}=i("triode"),{krush:Xa}=i("krush"),{kcutoff:Ya}=i("kcutoff"),{octer:tl}=i("octer"),{octersub:el}=i("octersub"),{octersubsub:nl}=i("octersubsub"),{ring:sl}=i("ring"),{ringf:rl}=i("ringf"),{ringdf:ol}=i("ringdf"),{freeze:il}=i("freeze"),{xsdelay:cl}=i("xsdelay"),{tsdelay:ul}=i("tsdelay"),{real:al}=i("real"),{imag:ll}=i("imag"),{enhance:fl}=i("enhance"),{comb:pl}=i("comb"),{smear:hl}=i("smear"),{scram:dl}=i("scram"),{binshift:ml}=i("binshift"),{hbrick:yl}=i("hbrick"),{lbrick:wl}=i("lbrick"),{frameRate:gl}=i("frameRate"),{frames:bl}=i("frames"),{hours:_l}=i("hours"),{minutes:vl}=i("minutes"),{seconds:kl}=i("seconds"),{songPtr:ql}=i("songPtr"),{uid:Al}=i("uid"),{val:Sl}=i("val"),{cps:Bl}=i("cps"),{clip:Tl,legato:Cl}=i("clip","legato"),{duration:xl,dur:Ol}=i("duration","dur"),{zrand:zl}=i("zrand"),{curve:Ml}=i("curve"),{deltaSlide:El}=i("deltaSlide"),{pitchJump:Nl}=i("pitchJump"),{pitchJumpTime:Pl}=i("pitchJumpTime"),{lfo:Il,repeatTime:jl}=i("lfo","repeatTime"),{znoise:Jl}=i("znoise"),{zmod:$l}=i("zmod"),{zcrush:Ll}=i("zcrush"),{zdelay:Rl}=i("zdelay"),{zzfx:Wl}=i("zzfx"),{color:Fl,colour:Vl}=i(["color","colour"]);let Dl=(...t)=>t.reduce((e,n)=>Object.assign(e,{[n]:It(n)}),{});const Hl=f("adsr",(t,e)=>{t=Array.isArray(t)?t:[t];const[n,s,r,o]=t;return e.set({attack:n,decay:s,sustain:r,release:o})}),Gl=f("ad",(t,e)=>{t=Array.isArray(t)?t:[t];const[n,s=n]=t;return e.attack(n).decay(s)}),Ql=f("ds",(t,e)=>{t=Array.isArray(t)?t:[t];const[n,s=0]=t;return e.set({decay:n,sustain:s})}),Ul=f("ar",(t,e)=>{t=Array.isArray(t)?t:[t];const[n,s=n]=t;return e.set({attack:n,release:s})}),{midichan:Kl}=i("midichan"),{midimap:Zl}=i("midimap"),{midiport:Xl}=i("midiport"),{midicmd:Yl}=i("midicmd"),tf=f("control",(t,e)=>{if(!Array.isArray(t))throw new Error("control expects an array of [ccn, ccv]");const[n,s]=t;return e.ccn(n).ccv(s)}),{ccn:ef}=i("ccn"),{ccv:nf}=i("ccv"),{ctlNum:sf}=i("ctlNum"),{nrpnn:rf}=i("nrpnn"),{nrpv:of}=i("nrpv"),{progNum:cf}=i("progNum"),uf=f("sysex",(t,e)=>{if(!Array.isArray(t))throw new Error("sysex expects an array of [id, data]");const[n,s]=t;return e.sysexid(n).sysexdata(s)}),{sysexid:af}=i("sysexid"),{sysexdata:lf}=i("sysexdata"),{midibend:ff}=i("midibend"),{miditouch:pf}=i("miditouch"),{polyTouch:hf}=i("polyTouch"),{oschost:df}=i("oschost"),{oscport:mf}=i("oscport"),le=t=>kt.has(t)?kt.get(t):t,yf=f("as",(t,e)=>(t=Array.isArray(t)?t:[t],e.fmap(n=>{n=Array.isArray(n)?n:[n];const s=[];for(let r=0;r<t.length;++r)n[r]!==void 0&&s.push([le(t[r]),n[r]]);return Object.fromEntries(s)}))),wf=f("scrub",(t,e)=>t.outerBind(n=>{Array.isArray(n)||(n=[n]);const[s,r=1]=n;return e.begin(s).mul(ae(r)).clip(1)}),!1),{transient:gf}=i(["transient","transsustain"]),Im=Object.freeze(Object.defineProperty({__proto__:null,accelerate:gs,activeLabel:Lu,ad:Gl,adsr:Hl,amp:qs,analyze:Jo,anchor:pa,ar:Ul,as:yf,att:Ss,attack:As,bandf:Go,bandq:Ko,bank:Io,bbexpr:bi,bbst:vi,begin:Xo,binshift:ml,bp:Uo,bpa:tc,bpattack:Yi,bpd:ic,bpdc:Pc,bpdecay:oc,bpdepth:zc,bpdepthfreq:Ec,bpdepthfrequency:Mc,bpe:Qi,bpenv:Gi,bpf:Qo,bpq:Zo,bpr:gc,bprate:xc,bprelease:wc,bps:pc,bpshape:Nc,bpskew:Ic,bpsustain:fc,bpsync:Oc,byteBeatExpression:gi,byteBeatStartTime:_i,ccn:ef,ccv:nf,ch:qi,channel:ji,channels:ki,chord:aa,chorus:jo,clip:Tl,coarse:ii,color:Fl,colour:Vl,comb:pl,compressor:Ia,compressorAttack:$a,compressorKnee:ja,compressorRatio:Ja,compressorRelease:La,control:tf,cps:Bl,createParam:It,createParams:Dl,crush:oi,ctf:Li,ctlNum:sf,ctranspose:Vu,curve:Ml,cut:Ji,cutoff:$i,dec:Ro,decay:Lo,degree:Wu,delay:ou,delayfb:cu,delayfeedback:iu,delayspeed:au,delaysync:hu,delayt:fu,delaytime:lu,deltaSlide:El,density:Pm,det:yu,detune:mu,dfb:uu,dict:fa,dictionary:la,dist:Ea,distort:Ma,distorttype:Pa,distortvol:Na,djf:ru,drive:hi,dry:bu,ds:Ql,dt:pu,duck:di,duckattack:wi,duckdepth:mi,duckonset:yi,dur:Ol,duration:xl,end:Yo,enhance:fl,expression:Ha,fadeInTime:ku,fadeOutTime:vu,fadeTime:_u,fanchor:_c,fft:$o,fm:Vs,fm1:Ds,fm2:Hs,fm3:Gs,fm4:Qs,fm5:Us,fm6:Ks,fm7:Zs,fm8:Xs,fmatt:wr,fmatt1:gr,fmatt2:br,fmatt3:_r,fmatt4:vr,fmatt5:kr,fmatt6:qr,fmatt7:Ar,fmatt8:Sr,fmattack:ur,fmattack1:ar,fmattack2:lr,fmattack3:fr,fmattack4:pr,fmattack5:hr,fmattack6:dr,fmattack7:mr,fmattack8:yr,fmdec:Vr,fmdec1:Dr,fmdec2:Hr,fmdec3:Gr,fmdec4:Qr,fmdec5:Ur,fmdec6:Kr,fmdec7:Zr,fmdec8:Xr,fmdecay:Pr,fmdecay1:Ir,fmdecay2:jr,fmdecay3:Jr,fmdecay4:$r,fmdecay5:Lr,fmdecay6:Rr,fmdecay7:Wr,fmdecay8:Fr,fmenv:Ys,fmenv1:tr,fmenv2:er,fmenv3:nr,fmenv4:sr,fmenv5:rr,fmenv6:or,fmenv7:ir,fmenv8:cr,fmh:Bs,fmh1:Ts,fmh2:Cs,fmh3:xs,fmh4:Os,fmh5:zs,fmh6:Ms,fmh7:Es,fmh8:Ns,fmi:Ps,fmi1:Is,fmi2:js,fmi3:Js,fmi4:$s,fmi5:Ls,fmi6:Rs,fmi7:Ws,fmi8:Fs,fmrel:To,fmrel1:Co,fmrel2:xo,fmrel3:Oo,fmrel4:zo,fmrel5:Mo,fmrel6:Eo,fmrel7:No,fmrel8:Po,fmrelease:go,fmrelease1:bo,fmrelease2:_o,fmrelease3:vo,fmrelease4:ko,fmrelease5:qo,fmrelease6:Ao,fmrelease7:So,fmrelease8:Bo,fmsus:uo,fmsus1:ao,fmsus2:lo,fmsus3:fo,fmsus4:po,fmsus5:ho,fmsus6:mo,fmsus7:yo,fmsus8:wo,fmsustain:Yr,fmsustain1:to,fmsustain2:eo,fmsustain3:no,fmsustain4:so,fmsustain5:ro,fmsustain6:oo,fmsustain7:io,fmsustain8:co,fmwave:Br,fmwave1:Tr,fmwave2:Cr,fmwave3:xr,fmwave4:Or,fmwave5:zr,fmwave6:Mr,fmwave7:Er,fmwave8:Nr,frameRate:gl,frames:bl,freeze:il,freq:qu,fshift:Qa,fshiftnote:Ua,fshiftphase:Ka,ftype:bc,gain:vs,gat:Iu,gate:Pu,getControlName:le,harmonic:Du,hbrick:yl,hcutoff:Zc,hold:Ho,hours:_l,hp:Yc,hpa:Xi,hpattack:Zi,hpd:rc,hpdc:Fc,hpdecay:sc,hpdepth:$c,hpdepthfreq:Rc,hpdepthfrequency:Lc,hpe:Hi,hpenv:Di,hpf:Xc,hpq:eu,hpr:yc,hprate:jc,hprelease:mc,hps:lc,hpshape:Wc,hpskew:Vc,hpsustain:ac,hpsync:Jc,hresonance:tu,imag:ll,ir:qa,irbegin:Ba,iresponse:Aa,irspeed:Sa,isControlName:Tn,kcutoff:Ya,krush:Xa,label:Ru,lbrick:wl,legato:Cl,leslie:ju,lfo:Il,lock:du,loop:ti,loopBegin:ei,loopEnd:si,loopb:ni,loope:ri,lp:Wi,lpa:Ki,lpattack:Ui,lpd:nc,lpdc:Tc,lpdecay:ec,lpdepth:qc,lpdepthfreq:Sc,lpdepthfrequency:Ac,lpe:Vi,lpenv:Fi,lpf:Ri,lpq:su,lpr:dc,lprate:vc,lprelease:hc,lps:uc,lpshape:Bc,lpskew:Cc,lpsustain:cc,lpsync:kc,lrate:Ju,lsize:$u,midibend:ff,midichan:Kl,midicmd:Yl,midimap:Zl,midiport:Xl,miditouch:pf,minutes:vl,mode:ma,mtranspose:Fu,n:ys,noise:Qc,note:ws,nrpnn:rf,nrpv:of,nudge:Qu,oct:Ku,octave:Uu,octaveR:Gu,octaves:da,octer:tl,octersub:el,octersubsub:nl,offset:ha,orbit:Zu,oschost:df,oscport:mf,overgain:Xu,overshape:Yu,pan:ta,panchor:Nu,panorient:ra,panspan:ea,pansplay:na,panwidth:sa,patt:Su,pattack:Au,pcurve:Eu,pdec:Tu,pdecay:Bu,penv:Mu,ph:Ci,phasdp:Ii,phaser:xi,phasercenter:Mi,phaserdepth:Ni,phaserrate:Ti,phasersweep:Oi,phc:Ei,phd:Pi,phs:zi,pitchJump:Nl,pitchJumpTime:Pl,polyTouch:hf,postgain:ks,prel:zu,prelease:Ou,progNum:cf,psus:xu,psustain:Cu,pw:Ai,pwrate:Si,pwsweep:Bi,rate:oa,rdim:_a,real:al,registerControl:i,registerMultiControl:K,rel:Do,release:Vo,repeatTime:jl,resonance:nu,rfade:ka,ring:sl,ringdf:ol,ringf:rl,rlp:ga,room:ya,roomdim:ba,roomfade:va,roomlp:wa,roomsize:Ta,rsize:Oa,s:Cn,scram:dl,scrub:wf,seconds:kl,semitone:ca,shape:za,size:Ca,slide:ia,smear:hl,songPtr:ql,sound:xn,source:ds,speed:ae,spread:gu,squiz:Fa,src:ms,stepsPerOctave:Hu,stretch:Ra,sus:Fo,sustain:Wo,sustainpedal:Ga,sysex:uf,sysexdata:lf,sysexid:af,sz:xa,transient:gf,tremolo:ci,tremolodepth:ai,tremolophase:fi,tremoloshape:pi,tremoloskew:li,tremolosync:ui,triode:Za,tsdelay:ul,uid:Al,unison:wu,unit:Wa,v:Gc,val:Sl,vel:_s,velocity:bs,vib:Dc,vibmod:Uc,vibrato:Hc,vmod:Kc,voice:ua,vowel:Va,warp:Gn,warpatt:Kn,warpattack:Un,warpdc:is,warpdec:Xn,warpdecay:Zn,warpdepth:rs,warpenv:ps,warpmode:us,warprate:ss,warprel:ns,warprelease:es,warpshape:os,warpskew:cs,warpsus:ts,warpsustain:Yn,warpsync:hs,waveloss:Da,wavetablePhaseRand:fs,wavetablePosition:zn,wavetableWarp:Qn,wavetableWarpMode:as,wt:On,wtatt:Nn,wtattack:En,wtdc:Dn,wtdec:In,wtdecay:Pn,wtdepth:Fn,wtenv:Mn,wtphaserand:ls,wtrate:Rn,wtrel:Ln,wtrelease:$n,wtshape:Vn,wtskew:Hn,wtsus:Jn,wtsustain:jn,wtsync:Wn,xsdelay:cl,zcrush:Ll,zdelay:Rl,zmod:$l,znoise:Jl,zrand:zl,zzfx:Wl},Symbol.toStringTag,{value:"Module"})),jm=function(t,e){const[n,s]=t,[r,o]=e,[c,u]=ee(s,r);return[[s,n-s],[Et((a,l)=>a.concat(l),c,o),u]]},Jm=function(t,e){const[n,s]=t,[r,o]=e,[c,u]=ee(n,o);return[[n,s-n],[Et((l,h)=>l.concat(h),r,c),u]]},bf=function(t,e){const[n,s]=t;return Math.min(n,s)<=1?[t,e]:bf(...n>s?jm(t,e):Jm(t,e))},fe=function(t,e){const n=t<0,s=Math.abs(t),r=e-s,o=Array(s).fill([1]),c=Array(r).fill([0]),u=bf([s,r],[o,c]),a=Y(u[1][0]).concat(Y(u[1][1]));return n?a.map(l=>1-l):a},jt=function(t,e,n){const s=fe(t,e);return n?Le(s,-n):s},$m=f("euclid",function(t,e,n){return n.struct(jt(t,e,0))}),Lm=f("bjork",function(t,e){Array.isArray(t)||(t=[t]);const[n,s=n,r=0]=t;return e.struct(jt(n,s,r))}),{euclidrot:Rm,euclidRot:Wm}=f(["euclidrot","euclidRot"],function(t,e,n,s){return s.struct(jt(t,e,n))}),_f=function(t,e,n,s){if(t<1)return S;const o=jt(t,e,0).join("").split("1").slice(1).map(c=>[c.length+1,!0]);return s.struct(kn(...o)).late(y(n).div(e))},Fm=f(["euclidLegato"],function(t,e,n){return _f(t,e,0,n)}),Vm=f(["euclidLegatoRot"],function(t,e,n,s){return _f(t,e,n,s)}),{euclidish:Dm,eish:Hm}=f(["euclidish","eish"],function(t,e,n,s){const r=ue(fe(t,e),new Array(t).fill(1),n);return s.struct(r).setSteps(e)});function vf(t,e,n=.05,s=.1,r=.1,o=globalThis.setInterval,c=globalThis.clearInterval,u=!0){let a=0,l=0,h=10**4,p=.01;const k=V=>n=V(n);r=r||s/2;const _=()=>{const V=t(),ot=V+s+r;for(l===0&&(l=V+p);l<ot;)l=u?Math.round(l*h)/h:l,e(l,n,a,V),l+=n,a++};let A;const O=()=>{W(),_(),A=o(_,s*1e3)},W=()=>{A!==void 0&&c(A),A=void 0};return{setDuration:k,start:O,stop:()=>{a=0,l=0,W()},pause:()=>W(),duration:n,interval:s,getPhase:()=>l,minLatency:p}}class kf{constructor({interval:e,onTrigger:n,onToggle:s,onError:r,getTime:o,latency:c=.1,setInterval:u,clearInterval:a,beforeStart:l}){this.started=!1,this.beforeStart=l,this.cps=.5,this.num_ticks_since_cps_change=0,this.lastTick=0,this.lastBegin=0,this.lastEnd=0,this.getTime=o,this.num_cycles_at_cps_change=0,this.seconds_at_cps_change,this.onToggle=s,this.latency=c,this.clock=vf(o,(h,p,k,_)=>{this.num_ticks_since_cps_change===0&&(this.num_cycles_at_cps_change=this.lastEnd,this.seconds_at_cps_change=h),this.num_ticks_since_cps_change++;const O=this.num_ticks_since_cps_change*p*this.cps;try{const W=this.lastEnd;this.lastBegin=W;const F=this.num_cycles_at_cps_change+O;if(this.lastEnd=F,this.lastTick=h,h<_){console.log("skip query: too late");return}this.pattern.queryArc(W,F,{_cps:this.cps,cyclist:"cyclist"}).forEach(z=>{if(z.hasOnset()){const V=(z.whole.begin-this.num_cycles_at_cps_change)/this.cps+this.seconds_at_cps_change+c,ot=z.duration/this.cps,et=V-h;n?.(z,et,ot,this.cps,V),z.value.cps!==void 0&&this.cps!=z.value.cps&&(this.cps=z.value.cps,this.num_ticks_since_cps_change=0)}})}catch(W){zt(W),r?.(W)}},e,.1,.1,u,a)}now(){if(!this.started)return 0;const e=this.getTime()-this.lastTick-this.clock.duration;return this.lastBegin+e*this.cps}setStarted(e){this.started=e,this.onToggle?.(e)}async start(){if(await this.beforeStart?.(),this.num_ticks_since_cps_change=0,this.num_cycles_at_cps_change=0,!this.pattern)throw new Error("Scheduler: no pattern set! call .setPattern first.");$("[cyclist] start"),this.clock.start(),this.setStarted(!0)}pause(){$("[cyclist] pause"),this.clock.pause(),this.setStarted(!1)}stop(){$("[cyclist] stop"),this.clock.stop(),this.lastEnd=0,this.setStarted(!1)}async setPattern(e,n=!1){this.pattern=e,n&&!this.started&&await this.start()}setCps(e=.5){this.cps!==e&&(this.cps=e,this.num_ticks_since_cps_change=0)}log(e,n,s){const r=s.filter(o=>o.hasOnset());console.log(`${e.toFixed(4)} - ${n.toFixed(4)} ${Array(r.length).fill("I").join("")}`)}}const qf={},Af=async(...t)=>{const e=await Promise.allSettled(t),n=e.filter(s=>s.status==="fulfilled").map(s=>s.value);return e.forEach((s,r)=>{s.status==="rejected"&&console.warn(`evalScope: module with index ${r} could not be loaded:`,s.reason)}),n.forEach(s=>{Object.entries(s).forEach(([r,o])=>{globalThis[r]=o,qf[r]=o})}),n};function Gm(t,e={}){const{wrapExpression:n=!0,wrapAsync:s=!0}=e;n&&(t=`{${t}}`),s&&(t=`(async ()=>${t})()`);const r=`"use strict";return (${t})`;return Function(r)()}const Sf=async(t,e,n)=>{let s={};if(e){const c=e(t,n);t=c.output,s=c}return{mode:"javascript",pattern:await Gm(t,{wrapExpression:!!e}),meta:s}};let bt={};const Bf=function(){Tf()},Tf=function(){bt={}},Qm=f("timeline",function(t,e){t=m(t);const n=function(s){const r=!!s.controls.cyclist,o=t.query(s),c=[];for(const u of o){const a=u.value;let l;if(a===0)l=0;else if(a in bt)l=bt[a];else{const p=u.wholeOrPart();!r||s.span.begin.lt(p.midpoint())?l=p.begin:l=p.end}r&&(bt[a]=l,a!==0&&delete bt[-a]);const h=e.late(l).query(s.setSpan(u.part)).map(p=>p.setContext(p.combineContext(u)));c.push(...h)}return c};return new d(n,e._steps)},!1),Z=function(t,e,n=!0){const s=Array.isArray(t),r=Object.keys(t).length;return t=Qe(t,m),r===0?S:e.fmap(o=>{let c=o;return s&&(c=n?Math.round(c)%r:Ve(Math.round(c),0,t.length-1)),t[c]})},Cf=function(t,e){return Array.isArray(e)&&([e,t]=[t,e]),Um(t,e)},Um=f("pick",function(t,e){return Z(t,e,!1).innerJoin()}),xf=f("pickmod",function(t,e){return Z(t,e,!0).innerJoin()}),Km=f("pickF",function(t,e,n){return n.apply(Cf(t,e))}),Zm=f("pickmodF",function(t,e,n){return n.apply(xf(t,e))}),Xm=f("pickOut",function(t,e){return Z(t,e,!1).outerJoin()}),Ym=f("pickmodOut",function(t,e){return Z(t,e,!0).outerJoin()}),ty=f("pickRestart",function(t,e){return Z(t,e,!1).restartJoin()}),ey=f("pickmodRestart",function(t,e){return Z(t,e,!0).restartJoin()}),ny=f("pickReset",function(t,e){return Z(t,e,!1).resetJoin()}),sy=f("pickmodReset",function(t,e){return Z(t,e,!0).resetJoin()}),{inhabit:ry,pickSqueeze:oy}=f(["inhabit","pickSqueeze"],function(t,e){return Z(t,e,!1).squeezeJoin()}),{inhabitmod:iy,pickmodSqueeze:cy}=f(["inhabitmod","pickmodSqueeze"],function(t,e){return Z(t,e,!0).squeezeJoin()}),uy=(t,e)=>(e=e.map(m),e.length==0?S:t.fmap(n=>{const s=At(Math.round(n),e.length);return e[s]}).squeezeJoin());class ay{constructor({onTrigger:e,onToggle:n,getTime:s}){this.started=!1,this.cps=.5,this.getTime=s,this.time_at_last_tick_message=0,this.collator=new Ue({getTargetClockTime:s}),this.onToggle=n,this.latency=.1,this.cycle=0,this.id=Math.round(Date.now()*Math.random()),this.worker=new SharedWorker(new URL("/strudel/_astro/clockworker-ZDiUtESR.js",import.meta.url)),this.worker.port.start(),this.channel=new BroadcastChannel("strudeltick");const r=c=>{const{cps:u,begin:a,end:l,cycle:h,time:p}=c;this.cps=u,this.cycle=h;const k=this.collator.calculateOffset(p)+p;o(a,l,k),this.time_at_last_tick_message=k},o=(c,u,a)=>{if(this.started===!1)return;this.pattern.queryArc(c,u,{_cps:this.cps,cyclist:"neocyclist"}).forEach(h=>{if(h.hasOnset()){const k=Vt(h.whole.begin-this.cycle,this.cps)+a+this.latency,_=Vt(h.duration,this.cps);e?.(h,0,_,this.cps,k)}})};this.channel.onmessage=c=>{if(!this.started)return;const{payload:u,type:a}=c.data;switch(a){case"tick":r(u)}}}sendMessage(e,n){this.worker.port.postMessage({type:e,payload:n,id:this.id})}now(){const e=(this.getTime()-this.time_at_last_tick_message)*this.cps;return this.cycle+e}setCps(e=1){this.sendMessage("cpschange",{cps:e})}setCycle(e){this.sendMessage("setcycle",{cycle:e})}setStarted(e){this.sendMessage("toggle",{started:e}),this.started=e,this.onToggle?.(e)}start(){$("[cyclist] start"),this.setStarted(!0)}stop(){$("[cyclist] stop"),this.collator.reset(),this.setStarted(!1)}setPattern(e,n=!1){this.pattern=e,n&&!this.started&&this.start()}log(e,n,s){const r=s.filter(o=>o.hasOnset());console.log(`${e.toFixed(4)} - ${n.toFixed(4)} ${Array(r.length).fill("I").join("")}`)}}let Ut;function ly(){if(!Ut)throw new Error("no time set! use setTime to define a time source");return Ut()}function Kt(t){Ut=t}function fy({defaultOutput:t,onEvalError:e,beforeEval:n,beforeStart:s,afterEval:r,getTime:o,transpiler:c,onToggle:u,editPattern:a,onUpdateState:l,sync:h=!1,setInterval:p,clearInterval:k,id:_,mondo:A=!1}){const O={schedulerError:void 0,evalError:void 0,code:"// LOADING",activeCode:"// LOADING",pattern:void 0,miniLocations:[],widgets:[],pending:!1,started:!1},W={id:_},F=q=>{Object.assign(O,q),O.isDirty=O.code!==O.activeCode,O.error=O.evalError||O.schedulerError,l?.(O)},yt={onTrigger:Of({defaultOutput:t,getTime:o}),getTime:o,onToggle:q=>{F({started:q}),u?.(q),q||Bf()},setInterval:p,clearInterval:k,beforeStart:s},z=h&&typeof SharedWorker<"u"?new ay(yt):new kf(yt);let V={},ot=0,et;const ke=function(){return V={},ot=0,et=void 0,S};function qe(q){return q._Pattern?q.__pure:q}const Ae=async(q,C=!0)=>(q=a?.(q)||q,await z.setPattern(q,C),q);Kt(()=>z.now());const Hf=()=>z.stop(),Gf=()=>z.start(),Qf=()=>z.pause(),Uf=()=>z.toggle(),Lt=q=>(z.setCps(qe(q)),S),Se=q=>(z.setCps(qe(q)/60),S);let Tt=[];const Kf=function(q){return Tt.push(q),S},Zf=function(q){return et=q,S},Xf=()=>{d.prototype.p=function(C){return typeof C=="string"&&(C.startsWith("_")||C.endsWith("_"))?S:(C.includes("$")&&(C=`${C}${ot}`,ot++),V[C]=this,this)},d.prototype.q=function(C){return S};try{for(let C=1;C<10;++C)Object.defineProperty(d.prototype,`d${C}`,{get(){return this.p(C)},configurable:!0}),Object.defineProperty(d.prototype,`p${C}`,{get(){return this.p(C)},configurable:!0}),d.prototype[`q${C}`]=S}catch(C){console.warn("injectPatternMethods: error:",C)}const q=f("cpm",function(C,Rt){return Rt._fast(C/60/z.cps)});return Af({all:Kf,each:Zf,hush:ke,cpm:q,setCps:Lt,setcps:Lt,setCpm:Se,setcpm:Se})};return{scheduler:z,evaluate:async(q,C=!0,Rt=!0)=>{if(!q)throw new Error("no code to evaluate");try{F({code:q,pending:!0}),await Xf(),Kt(()=>z.now()),await n?.({code:q}),Tt=[],Rt&&ke(),A&&(q=`mondolang\`${q}\``);let{pattern:P,meta:Wt}=await Sf(q,c,W);if(Object.keys(V).length){let it=[],Ct=!1;for(const[wt,Yf]of Object.entries(V)){const Be=wt.length>1&&wt.startsWith("S");if(Be&&Ct===!1&&(it=[],Ct=!0),!Ct||Ct&&Be){const tp=Yf.withState(ep=>ep.setControls({id:wt}));it.push(tp)}}et&&(it=it.map(wt=>et(wt))),P=E(...it)}else et&&(P=et(P));if(Tt.length)for(const it of Tt)P=it(P);return se(P)||(P=S),$("[eval] code updated"),P=await Ae(P,C),F({miniLocations:Wt?.miniLocations||[],widgets:Wt?.widgets||[],activeCode:q,pattern:P,evalError:void 0,schedulerError:void 0,pending:!1}),r?.({code:q,pattern:P,meta:Wt}),P}catch(P){$(`[eval] error: ${P.message}`,"error"),console.error(P),F({evalError:P,pending:!1}),e?.(P)}},start:Gf,stop:Hf,pause:Qf,setCps:Lt,setPattern:Ae,setCode:q=>F({code:q}),toggle:Uf,state:O}}const Of=({getTime:t,defaultOutput:e})=>async(n,s,r,o,c)=>{try{(!n.context.onTrigger||!n.context.dominantTrigger)&&await e(n,s,r,o,c),n.context.onTrigger&&await n.context.onTrigger(n,t(),o,c)}catch(u){zt(u,"getTrigger")}};function py(t){return new d(e=>[new T(void 0,e.span,t)])}const j=t=>{const e=n=>[new T(void 0,n.span,t(n.span.begin,n.controls))];return new d(e)},Bt=j(t=>t%1),pe=Bt.toBipolar(),Jt=j(t=>1-t%1),he=Jt.toBipolar(),de=j(t=>Math.sin(Math.PI*2*t)),zf=de.fromBipolar(),hy=zf._early(y(1).div(4)),dy=de._early(y(1).div(4)),Mf=j(t=>Math.floor(t*2%2)),my=Mf.toBipolar(),yy=R(Bt,Jt),wy=R(pe,he),gy=R(Jt,Bt),by=R(he,pe),_y=j(lt);let me=0,ye=0;typeof window<"u"&&document.addEventListener("mousemove",t=>{me=t.clientY/document.body.clientHeight,ye=t.clientX/document.body.clientWidth});const vy=j(()=>me),ky=j(()=>me),qy=j(()=>ye),Ay=j(()=>ye),Sy=t=>(t|=0,t^=t>>>16,t=Math.imul(t,2246822507),t^=t>>>13,t=Math.imul(t,3266489909),t^=t>>>16,t>>>0),By=t=>Math.floor(t*536870912),Ty=(t,e=0,n=0)=>{const s=t>>>0>>>0,r=Math.floor(t/4294967296)>>>0;let o=s^Math.imul(r^2246822507,3266489909);return o^=Math.imul(e^2135587861,2654435769),o^=Math.imul(n^374761393,668265261),o>>>0},ze=(t,e=0,n=0)=>Sy(Ty(t,e,n))/4294967296,Cy=(t,e,n=0)=>{const s=By(t);if(e===1)return ze(s,0,n);const r=new Array(e);for(let o=0;o<e;o++)r[o]=ze(s,o,n);return r},Ef=t=>{const e=t<<13^t,n=e>>17^e;return n<<5^n},xy=t=>t-Math.trunc(t),Oy=t=>Ef(Math.trunc(xy(t/300)*536870912)),Me=t=>t%536870912/536870912,zy=(t,e)=>{if(e===1)return Math.abs(Me(t));const n=[];for(let s=0;s<e;s++)n.push(Me(t)),t=Ef(t);return n},My=(t,e)=>zy(Oy(t),e);let Nf="legacy";const st=(t,e=1,n=0)=>Nf==="legacy"?My(t+n,e):Cy(t,e,n),Ey=(t="legacy")=>Nf=t,Pf=t=>Bt.range(0,t).round().segment(t),Ny=t=>{const e=m(t).log2(0).floor().add(1);return If(t,e)},If=(t,e=16)=>{e=m(e);const n=Pf(e).mul(-1).add(e.sub(1));return m(t).segment(e).brshift(n).band(I(1))},Py=t=>{const e=m(t).log2(0).floor().add(1);return jf(t,e)},jf=(t,e=16)=>m(t).withValue(n=>s=>{const r=[];for(let o=s-1;o>=0;o--)r.push(n>>o&1);return r}).appLeft(m(e)),Iy=t=>j(e=>n=>st(e,n).map(Math.abs)).appLeft(m(t)),Jf=t=>j((e,n)=>{const r=st(e.floor().add(.5),t,n.randSeed).map((c,u)=>[c,u]).sort((c,u)=>(c[0]>u[0])-(c[0]<u[0])).map(c=>c[1]),o=e.cyclePos().mul(t).floor()%t;return r[o]})._segment(t),$f=(t,e,n)=>{const s=[...Array(e).keys()].map(r=>n.zoom(y(r).div(e),y(r+1).div(e)));return t.fmap(r=>s[r].repeatCycles(e)._fast(e)).innerJoin()},jy=f("shuffle",(t,e)=>$f(Jf(t),t,e)),Jy=f("scramble",(t,e)=>$f(ge(t)._segment(t),t,e)),Lf=(t,e)=>new d(n=>{let{randSeed:s,...r}=n.controls;return s=t(s),e.query(n.setControls({...r,randSeed:s}))},e._steps),$y=f("seed",(t,e)=>Lf(()=>t,e)),Q=j((t,e)=>st(t,1,e.randSeed)),Ly=Q.toBipolar(),we=t=>Q.fmap(e=>e<t),Ry=t=>m(t).fmap(we).innerJoin(),Wy=we(.5),ge=t=>Q.fmap(e=>Math.trunc(e*t)),Fy=t=>m(t).fmap(ge).innerJoin(),be=(t,e)=>(e=e.map(m),e.length==0?S:t.range(0,e.length).fmap(n=>{const s=Math.min(Math.max(Math.floor(n),0),e.length-1);return e[s]})),$t=(t,e)=>be(t,e).outerJoin(),_e=(t,e)=>be(t,e).innerJoin(),Rf=(...t)=>$t(Q,t),Vy=(...t)=>_e(Q,t),Dy=Rf;d.prototype.choose=function(...t){return $t(this,t)};d.prototype.choose2=function(...t){return $t(this.fromBipolar(),t)};const Wf=(...t)=>_e(Q.segment(1),t),Hy=Wf,Ff=function(t,...e){const n=e.map(u=>m(u[0])),s=[];let r=I(0);for(const u of e)r=r.add(u[1]),s.push(r);const o=Ye(s),c=function(u){const a=r.mul(u);return o.fmap(l=>h=>n[l.findIndex(p=>p>h,l)]).appLeft(a)};return t.bind(c)},Gy=(...t)=>Ff(...t).outerJoin(),Qy=(...t)=>Gy(Q,...t),Vf=(...t)=>Ff(Q.segment(1),...t).innerJoin(),Uy=Vf;function Ky(t,e=0){let n=Math.floor(t),s=n+1;const r=l=>6*l**5-15*l**4+10*l**3,o=l=>h=>p=>h+r(l)*(p-h),c=st(n,1,e),u=st(s,1,e);return o(t-n)(c)(u)}function Zy(t,e=0){const n=Math.floor(t),s=n+1,r=st(n,1,e),o=st(s,1,e),c=r+o,u=(t-n)/(s-n);return((l,h,p)=>l+p*(h-l))(r,c,u)/2}const Xy=j((t,e)=>Ky(t,e.randSeed)),Yy=j((t,e)=>Zy(t,e.randSeed)),tw=f("degradeByWith",(t,e,n)=>n.fmap(s=>r=>s).appLeft(t.filterValues(s=>s>e)),!0,!0),ew=f("degradeBy",function(t,e){return e._degradeByWith(Q,t)},!0,!0),nw=f("degrade",t=>t._degradeBy(.5),!0,!0),sw=f("undegradeBy",function(t,e){return e._degradeByWith(Q.fmap(n=>1-n),t)},!0,!0),rw=f("undegrade",t=>t._undegradeBy(.5),!0,!0),ow=f("sometimesBy",function(t,e,n){return m(t).fmap(s=>E(n._degradeBy(s),e(n._undegradeBy(1-s)))).innerJoin()}),iw=f("sometimes",function(t,e){return e._sometimesBy(.5,t)}),cw=f("someCyclesBy",function(t,e,n){return m(t).fmap(s=>E(n._degradeByWith(Q._segment(1),s),e(n._degradeByWith(Q.fmap(r=>1-r)._segment(1),1-s)))).innerJoin()}),uw=f("someCycles",function(t,e){return e._someCyclesBy(.5,t)}),aw=f("often",function(t,e){return e.sometimesBy(.75,t)}),lw=f("rarely",function(t,e){return e.sometimesBy(.25,t)}),fw=f("almostNever",function(t,e){return e.sometimesBy(.1,t)}),pw=f("almostAlways",function(t,e){return e.sometimesBy(.9,t)}),hw=f("never",function(t,e){return e}),dw=f("always",function(t,e){return t(e)});function ve(t){Array.isArray(t)===!1&&(t=[t]);const e=Ze();return t.every(n=>{const s=Ke.get(n)??n;return e[s]})}const mw=f("whenKey",function(t,e,n){return n.when(ve(t),e)}),yw=f("keyDown",function(t){return t.fmap(ve)}),ww=new d(function(t){return[new T(void 0,t.span,t.span.duration)]}),Df=new d(function(t){return[new T(void 0,t.span,y(1).div(t.span.duration))]}),gw=Df,bw=new d(function(t){const e=y(1).div(t.span.duration);return[new T(void 0,t.span,Math.log(e)/Math.log(2)+1)]});let Ot;try{Ot=window?.speechSynthesis}catch{console.warn("cannot use window: not in browser?")}let Ee=Ot?.getVoices();function _w(t,e,n){Ot.cancel();const s=new SpeechSynthesisUtterance(t);s.lang=e,Ee=Ot.getVoices();const r=Ee.filter(o=>o.lang.includes(e));typeof n=="number"?s.voice=r[n%r.length]:typeof n=="string"&&(s.voice=r.find(o=>o.name===o)),speechSynthesis.speak(s)}const vw=f("speak",function(t,e,n){return n.onTrigger(s=>{_w(s.value,t,e)})}),kw=function(t,e={}){const n=document.getElementById("code"),s="background-image:url("+t+");background-size:contain;";n.style=s;const{className:r}=n,o=(a,l)=>{({style:()=>n.style=s+";"+l,className:()=>n.className=l+" "+r})[a]()},c=Object.entries(e).filter(([a,l])=>typeof l=="function");Object.entries(e).filter(([a,l])=>typeof l=="string").forEach(([a,l])=>o(a,l)),c.length},qw=()=>{const t=document.getElementById("code");t&&(t.style="")};$("🌀 @strudel/core loaded 🌀");globalThis._strudelLoaded&&console.warn(`@strudel/core was loaded more than once...
This might happen when you have multiple versions of strudel installed. 
Please check with "npm ls @strudel/core".`);globalThis._strudelLoaded=!0;const Tw=Object.freeze(Object.defineProperty({__proto__:null,ClockCollator:Ue,Cyclist:kf,Fraction:y,Hap:T,Pattern:d,State:pt,TimeSpan:M,__chooseWith:be,_brandBy:we,_fitslice:un,_irand:ge,_keyDown:ve,_match:an,_mod:At,_morph:ue,_polymeterListSteps:fn,_retime:Gt,_slices:Qt,accelerate:gs,activeLabel:Lu,ad:Gl,add:uh,adsr:Hl,almostAlways:pw,almostNever:fw,always:dw,amp:qs,analyze:Jo,anchor:pa,and:Th,apply:sd,applyN:cn,ar:Ul,arp:Rp,arpWith:Lp,arrange:Gp,as:yf,att:Ss,attack:As,averageArray:Je,backgroundImage:kw,band:dh,bandf:Go,bandq:Ko,bank:Io,base64ToUnicode:Ge,bbexpr:bi,bbst:vi,beat:Om,begin:Xo,berlin:Yy,binary:Ny,binaryL:Py,binaryN:If,binaryNL:jf,bind:Yp,binshift:ml,bite:ad,bjork:Lm,bjorklund:fe,blshift:wh,bor:mh,bp:Uo,bpa:tc,bpattack:Yi,bpd:ic,bpdc:Pc,bpdecay:oc,bpdepth:zc,bpdepthfreq:Ec,bpdepthfrequency:Mc,bpe:Qi,bpenv:Gi,bpf:Qo,bpq:Zo,bpr:gc,bprate:xc,bprelease:wc,bps:pc,bpshape:Nc,bpskew:Ic,bpsustain:fc,bpsync:Oc,brak:bd,brand:Wy,brandBy:Ry,brshift:gh,bxor:yh,bypass:Kd,byteBeatExpression:gi,byteBeatStartTime:_i,calculateSteps:Ip,cat:vt,ccn:ef,ccv:nf,ceil:Mh,ch:qi,channel:ji,channels:ki,choose:Rf,chooseCycles:Wf,chooseIn:Vy,chooseInWith:_e,chooseOut:Dy,chooseWith:$t,chop:_m,chord:aa,chorus:jo,chunk:$d,chunkBack:Wd,chunkBackInto:Ud,chunkInto:Gd,chunkback:Fd,chunkbackinto:Qd,chunkinto:Hd,clamp:Ve,cleanupUi:qw,clip:Tl,coarse:ii,code2hash:xp,color:Fl,colour:Vl,comb:pl,compose:wp,compress:$h,compressSpan:Lh,compressor:Ia,compressorAttack:$a,compressorKnee:ja,compressorRatio:Ja,compressorRelease:La,compressspan:Rh,constant:gp,contract:wn,control:tf,controls:Im,cosine:hy,cosine2:dy,cpm:rd,cps:Bl,createClock:vf,createParam:It,createParams:Dl,crush:oi,ctf:Li,ctlNum:sf,ctranspose:Vu,curry:v,curve:Ml,cut:Ji,cutoff:$i,cycleToSeconds:Vt,cyclesPer:ww,dec:Ro,decay:Lo,degrade:nw,degradeBy:ew,degradeByWith:tw,degree:Wu,delay:ou,delayfb:cu,delayfeedback:iu,delayspeed:au,delaysync:hu,delayt:fu,delaytime:lu,deltaSlide:El,det:yu,detune:mu,dfb:uu,dict:fa,dictionary:la,dist:Ea,distort:Ma,distorttype:Pa,distortvol:Na,div:fh,djf:ru,drawLine:Xe,drive:hi,drop:dn,dry:bu,ds:Ql,dt:pu,duck:di,duckattack:wi,duckdepth:mi,duckonset:yi,dur:Ol,duration:xl,early:od,echo:zd,echoWith:Td,echowith:Cd,eish:Hm,end:Yo,enhance:fl,eq:qh,eqt:Ah,errorLogger:zt,euclid:$m,euclidLegato:Fm,euclidLegatoRot:Vm,euclidRot:Wm,euclidish:Dm,euclidrot:Rm,evalScope:Af,evaluate:Sf,every:nd,expand:yn,expression:Ha,extend:mn,fadeInTime:ku,fadeOutTime:vu,fadeTime:_u,fanchor:_c,fast:Qh,fastChunk:Dd,fastGap:Wh,fastcat:R,fastchunk:Vd,fastgap:Fh,fft:$o,filter:em,filterWhen:nm,firstOf:ed,fit:Sm,flatten:Y,floor:zh,fm:Vs,fm1:Ds,fm2:Hs,fm3:Gs,fm4:Qs,fm5:Us,fm6:Ks,fm7:Zs,fm8:Xs,fmatt:wr,fmatt1:gr,fmatt2:br,fmatt3:_r,fmatt4:vr,fmatt5:kr,fmatt6:qr,fmatt7:Ar,fmatt8:Sr,fmattack:ur,fmattack1:ar,fmattack2:lr,fmattack3:fr,fmattack4:pr,fmattack5:hr,fmattack6:dr,fmattack7:mr,fmattack8:yr,fmdec:Vr,fmdec1:Dr,fmdec2:Hr,fmdec3:Gr,fmdec4:Qr,fmdec5:Ur,fmdec6:Kr,fmdec7:Zr,fmdec8:Xr,fmdecay:Pr,fmdecay1:Ir,fmdecay2:jr,fmdecay3:Jr,fmdecay4:$r,fmdecay5:Lr,fmdecay6:Rr,fmdecay7:Wr,fmdecay8:Fr,fmenv:Ys,fmenv1:tr,fmenv2:er,fmenv3:nr,fmenv4:sr,fmenv5:rr,fmenv6:or,fmenv7:ir,fmenv8:cr,fmh:Bs,fmh1:Ts,fmh2:Cs,fmh3:xs,fmh4:Os,fmh5:zs,fmh6:Ms,fmh7:Es,fmh8:Ns,fmi:Ps,fmi1:Is,fmi2:js,fmi3:Js,fmi4:$s,fmi5:Ls,fmi6:Rs,fmi7:Ws,fmi8:Fs,fmrel:To,fmrel1:Co,fmrel2:xo,fmrel3:Oo,fmrel4:zo,fmrel5:Mo,fmrel6:Eo,fmrel7:No,fmrel8:Po,fmrelease:go,fmrelease1:bo,fmrelease2:_o,fmrelease3:vo,fmrelease4:ko,fmrelease5:qo,fmrelease6:Ao,fmrelease7:So,fmrelease8:Bo,fmsus:uo,fmsus1:ao,fmsus2:lo,fmsus3:fo,fmsus4:po,fmsus5:ho,fmsus6:mo,fmsus7:yo,fmsus8:wo,fmsustain:Yr,fmsustain1:to,fmsustain2:eo,fmsustain3:no,fmsustain4:so,fmsustain5:ro,fmsustain6:oo,fmsustain7:io,fmsustain8:co,fmwave:Br,fmwave1:Tr,fmwave2:Cr,fmwave3:xr,fmwave4:Or,fmwave5:zr,fmwave6:Mr,fmwave7:Er,fmwave8:Nr,focus:Vh,focusSpan:Dh,focusspan:Hh,fractionalArgs:bp,frameRate:gl,frames:bl,freeze:il,freq:qu,freqToMidi:Ie,fromBipolar:Nh,fshift:Qa,fshiftnote:Ua,fshiftphase:Ka,ftype:bc,func:xh,gain:vs,gap:dt,gat:Iu,gate:Pu,getAccidentalsOffset:Pe,getControlName:le,getCurrentKeyboardState:Ze,getEventOffsetMs:fp,getFreq:je,getFrequency:yp,getPerformanceTimeSeconds:zp,getPlayableNoteValue:mp,getRandsAtTime:st,getSoundIndex:dp,getTime:ly,getTrigger:Of,grow:om,gt:_h,gte:kh,harmonic:Du,hash2code:Op,hbrick:yl,hcutoff:Zc,hold:Ho,hours:_l,hp:Yc,hpa:Xi,hpattack:Zi,hpd:rc,hpdc:Fc,hpdecay:sc,hpdepth:$c,hpdepthfreq:Rc,hpdepthfrequency:Lc,hpe:Hi,hpenv:Di,hpf:Xc,hpq:eu,hpr:yc,hprate:jc,hprelease:mc,hps:lc,hpshape:Wc,hpskew:Vc,hpsustain:ac,hpsync:Jc,hresonance:tu,hsl:tm,hsla:Yd,hurry:Uh,id:lt,imag:ll,inhabit:ry,inhabitmod:iy,innerBind:th,inside:Xh,inv:yd,invert:md,ir:qa,irand:Fy,irbegin:Ba,iresponse:Aa,irspeed:Sa,isControlName:Tn,isNote:Mt,isNoteWithOctave:cp,isPattern:se,isaw:Jt,isaw2:he,iter:Pd,iterBack:Id,iterback:jd,itri:gy,itri2:by,jux:Bd,juxBy:Ad,juxby:Sd,kcutoff:Ya,keep:ih,keepif:ch,keyAlias:Ke,keyDown:yw,krush:Xa,label:Ru,lastOf:td,late:rn,lbrick:wl,legato:Cl,leslie:ju,lfo:Il,linger:ld,listRange:St,lock:du,logKey:Xt,logger:$,loop:ti,loopAt:qm,loopAtCps:Bm,loopBegin:ei,loopEnd:si,loopat:Am,loopatcps:Tm,loopb:ni,loope:ri,lp:Wi,lpa:Ki,lpattack:Ui,lpd:nc,lpdc:Tc,lpdecay:ec,lpdepth:qc,lpdepthfreq:Sc,lpdepthfrequency:Ac,lpe:Vi,lpenv:Fi,lpf:Ri,lpq:su,lpr:dc,lprate:vc,lprelease:hc,lps:uc,lpshape:Bc,lpskew:Cc,lpsustain:cc,lpsync:kc,lrate:Ju,lsize:$u,lt:bh,lte:vh,mapArgs:te,mask:Up,midi2note:hp,midiToFreq:ft,midibend:ff,midichan:Kl,midicmd:Yl,midimap:Zl,midiport:Xl,miditouch:pf,minutes:vl,mod:ph,mode:ma,morph:zm,mouseX:Ay,mouseY:ky,mousex:qy,mousey:vy,mtranspose:Fu,mul:lh,n:ys,nanFallback:$e,ne:Sh,net:Bh,never:hw,noise:Qc,note:ws,noteToMidi:qt,nothing:H,nrpnn:rf,nrpv:of,nudge:Qu,numeralArgs:D,objectMap:Qe,oct:Ku,octave:Uu,octaveR:Gu,octaves:da,octer:tl,octersub:el,octersubsub:nl,off:gd,offset:ha,often:aw,or:Ch,orbit:Zu,oschost:df,oscport:mf,outerBind:eh,outside:Yh,overgain:Xu,overshape:Yu,pace:ln,pairs:Fe,palindrome:qd,pan:ta,panchor:Nu,panorient:ra,panspan:ea,pansplay:na,panwidth:sa,parray:Bn,parseFractional:We,parseNumeral:Yt,partials:Em,patt:Su,pattack:Au,pcurve:Eu,pdec:Tu,pdecay:Bu,penv:Mu,per:Df,perCycle:gw,perlin:Xy,perx:bw,ph:Ci,phasdp:Ii,phaser:xi,phasercenter:Mi,phaserdepth:Ni,phaserrate:Ti,phasersweep:Oi,phases:Nm,phc:Ei,phd:Pi,phs:zi,pick:Cf,pickF:Km,pickOut:Xm,pickReset:ny,pickRestart:ty,pickSqueeze:oy,pickmod:xf,pickmodF:Zm,pickmodOut:Ym,pickmodReset:sy,pickmodRestart:ey,pickmodSqueeze:cy,pipe:Re,pitchJump:Nl,pitchJumpTime:Pl,ply:Gh,plyForEach:Nd,plyWith:Ed,pm:Dp,polyBind:rh,polyTouch:hf,polymeter:Nt,polyrhythm:Fp,postgain:ks,pow:hh,pr:Vp,prel:zu,prelease:Ou,press:kd,pressBy:vd,progNum:cf,psus:xu,psustain:Cu,pure:I,pw:Ai,pwrate:Si,pwsweep:Bi,rand:Q,rand2:Ly,randL:Iy,randcat:Hy,randrun:Jf,range:Ph,range2:jh,rangex:Ih,rarely:lw,rate:oa,ratio:Jh,rdim:_a,real:al,ref:Cm,register:f,registerControl:i,registerMultiControl:K,reify:m,rel:Do,release:Vo,removeUndefineds:ht,repeatCycles:Jd,repeatTime:jl,repl:fy,replicate:rm,reset_state:Bf,reset_timelines:Tf,resonance:nu,rev:on,revv:_d,rfade:ka,rib:Xd,ribbon:Zd,ring:sl,ringdf:ol,ringf:rl,rlp:ga,room:ya,roomdim:ba,roomfade:va,roomlp:wa,roomsize:Ta,rotate:Le,round:Oh,rsize:Oa,run:Pf,s:Cn,s_add:pm,s_alt:um,s_cat:cm,s_contract:ym,s_expand:dm,s_extend:mm,s_polymeter:am,s_sub:hm,s_taper:lm,s_taperlist:fm,s_tour:wm,s_zip:gm,saw:Bt,saw2:pe,scram:dl,scramble:Jy,scrub:wf,seconds:kl,seed:$y,seg:pd,segment:fd,semitone:ca,seq:sn,seqPLoop:Qp,sequence:tt,sequenceP:Ye,set:oh,setStringParser:jp,setTime:Kt,shape:za,shrink:bn,shrinklist:gn,shuffle:jy,signal:j,silence:S,sine:zf,sine2:de,size:Ca,slice:An,slide:ia,slow:Kh,slowChunk:Rd,slowcat:rt,slowcatPrime:oe,slowchunk:Ld,smear:hl,sol2note:Bp,someCycles:uw,someCyclesBy:cw,sometimes:iw,sometimesBy:ow,songPtr:ql,sound:xn,source:ds,sparsity:Zh,speak:vw,speed:ae,splice:km,splitAt:ee,spread:gu,square:Mf,square2:my,squeeze:uy,squeezeBind:nh,squiz:Fa,src:ms,stack:E,stackBy:Hp,stackCentre:nn,stackLeft:tn,stackRight:en,steady:py,stepBind:sh,stepalt:pn,stepcat:L,steps:bm,stepsPerOctave:Hu,stretch:Ra,striate:vm,stringifyValues:ne,struct:Kp,strudelScope:qf,stut:Md,stutWith:xd,stutwith:Od,sub:ah,superimpose:Zp,sus:Fo,sustain:Wo,sustainpedal:Ga,swing:dd,swingBy:hd,sysex:uf,sysexdata:lf,sysexid:af,sz:xa,take:hn,time:_y,timeCat:kn,timecat:im,timeline:Qm,toBipolar:Eh,tokenizeNote:Ne,tour:_n,transient:gf,tremolo:ci,tremolodepth:ai,tremolophase:fi,tremoloshape:pi,tremoloskew:li,tremolosync:ui,tri:yy,tri2:wy,triode:Za,tsdelay:ul,uid:Al,undegrade:rw,undegradeBy:sw,unicodeToBase64:He,uniq:Tp,uniqsort:Cp,uniqsortr:De,unison:wu,unit:Wa,useRNG:Ey,v:Gc,val:Sl,valueToMidi:lp,vel:_s,velocity:bs,vib:Dc,vibmod:Uc,vibrato:Hc,vmod:Kc,voice:ua,vowel:Va,warp:Gn,warpatt:Kn,warpattack:Un,warpdc:is,warpdec:Xn,warpdecay:Zn,warpdepth:rs,warpenv:ps,warpmode:us,warprate:ss,warprel:ns,warprelease:es,warpshape:os,warpskew:cs,warpsus:ts,warpsustain:Yn,warpsync:hs,waveloss:Da,wavetablePhaseRand:fs,wavetablePosition:zn,wavetableWarp:Qn,wavetableWarpMode:as,wchoose:Qy,wchooseCycles:Vf,when:wd,whenKey:mw,withSeed:Lf,withValue:Xp,within:sm,wrandcat:Uy,wt:On,wtatt:Nn,wtattack:En,wtdc:Dn,wtdec:In,wtdecay:Pn,wtdepth:Fn,wtenv:Mn,wtphaserand:ls,wtrate:Rn,wtrel:Ln,wtrelease:$n,wtshape:Vn,wtskew:Hn,wtsus:Jn,wtsustain:jn,wtsync:Wn,xfade:Sn,xsdelay:cl,zcrush:Ll,zdelay:Rl,zip:vn,zipWith:Et,zmod:$l,znoise:Jl,zoom:id,zoomArc:cd,zoomarc:ud,zrand:zl,zzfx:Wl},Symbol.toStringTag,{value:"Module"}));export{fy as $,Cm as A,yp as B,Ue as C,xp as D,Dl as E,I as F,Ie as G,ft as H,dp as I,mp as J,Tw as K,Ve as L,y as M,kn as N,ut as O,d as P,tt as Q,R,_e as S,Q as T,E as U,jp as V,zt as W,ht as X,Pe as Y,i as Z,At as _,za as a,Sf as a0,zp as a1,lp as a2,Af as a3,Op as a4,j as b,f as c,fp as d,S as e,qf as f,ly as g,L as h,Mt as i,Qh as j,Kh as k,$ as l,hp as m,qt as n,rm as o,Yt as p,yn as q,m as r,ae as s,ln as t,ew as u,Lm as v,Vy as w,sn as x,se as y,le as z};
